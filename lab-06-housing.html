<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="lab-06-housing_files/libs/quarto-html/tabby.min.js"></script>
<script src="lab-06-housing_files/libs/quarto-html/popper.min.js"></script>
<script src="lab-06-housing_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lab-06-housing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab-06-housing_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lab-06-housing_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lab-06-housing_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Matteo Francia   DISI — University of Bologna   m.francia@unibo.it">
  <title>Machine Learning and Data Mining (Module 2)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lab-06-housing_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lab-06-housing_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lab-06-housing_files/libs/revealjs/dist/theme/quarto.css">
  <link href="lab-06-housing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lab-06-housing_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Machine Learning and Data Mining (Module 2)</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Matteo Francia <br> DISI — University of Bologna <br> m.francia@unibo.it 
</div>
</div>
</div>

</section>
<section class="slide level2">

<p><a href="https://colab.research.google.com/github/w4bo/AA2425-unibo-mldm/blob/master/slides/lab-06-housing.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
</section>
<section>
<section id="the-california-housing-case-study" class="title-slide slide level1 center">
<h1>The <a href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/"><code>California Housing</code></a> case study</h1>
<p>Our task is to use California census data to forecast housing prices given the population, median income, and median housing price for each block group in California. Block groups are the smallest geographical unit for which the US Census Bureau publishes sample data (a block group typically has a population of 600 to 3,000 people). We will just call them “districts” for short.</p>
</section>
<section id="solution-of-the-previous-hands-on" class="slide level2">
<h2>Solution of the previous <code>Hands on</code></h2>
<div id="87eb7c60" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:33.335771Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:33.335431Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:33.429083Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:33.428502Z&quot;}" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="kw">def</span> preprocess(normalize<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb1-2"><a href=""></a>    df <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/w4bo/handsOnDataPipelines/main/materials/datasets/housing.csv"</span>, delimiter<span class="op">=</span><span class="st">","</span>)</span>
<span id="cb1-3"><a href=""></a>    num_df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"ocean_proximity"</span>, <span class="st">"median_house_value"</span>])</span>
<span id="cb1-4"><a href=""></a>    <span class="co"># Filling in (i.e., impute) missing values with the median value</span></span>
<span id="cb1-5"><a href=""></a>    num_df[<span class="st">"total_bedrooms"</span>] <span class="op">=</span> num_df[<span class="st">"total_bedrooms"</span>].fillna(num_df[<span class="st">"total_bedrooms"</span>].median())</span>
<span id="cb1-6"><a href=""></a>    <span class="co"># Add a new column: population_per_household = population / households</span></span>
<span id="cb1-7"><a href=""></a>    num_df[<span class="st">"population_per_household"</span>] <span class="op">=</span> num_df[<span class="st">"population"</span>] <span class="op">/</span> num_df[<span class="st">"households"</span>]</span>
<span id="cb1-8"><a href=""></a>    <span class="co"># Add a new column: rooms_per_household = total_rooms / households</span></span>
<span id="cb1-9"><a href=""></a>    num_df[<span class="st">"rooms_per_household"</span>] <span class="op">=</span> num_df[<span class="st">"total_rooms"</span>] <span class="op">/</span> num_df[<span class="st">"households"</span>]</span>
<span id="cb1-10"><a href=""></a>    <span class="co"># Add a new column: bedrooms_per_room = total_bedrooms / total_rooms</span></span>
<span id="cb1-11"><a href=""></a>    num_df[<span class="st">"bedrooms_per_room"</span>] <span class="op">=</span> num_df[<span class="st">"total_bedrooms"</span>] <span class="op">/</span> num_df[<span class="st">"total_rooms"</span>]</span>
<span id="cb1-12"><a href=""></a>    <span class="cf">if</span> normalize:</span>
<span id="cb1-13"><a href=""></a>        <span class="co"># Apply standardization to all the numeric columns</span></span>
<span id="cb1-14"><a href=""></a>        num_df <span class="op">=</span> (num_df <span class="op">-</span> num_df.mean()) <span class="op">/</span> num_df.std()</span>
<span id="cb1-15"><a href=""></a>    <span class="co"># One hot encode `ocean_proximity` since it is a categorical attribute</span></span>
<span id="cb1-16"><a href=""></a>    cat_df <span class="op">=</span> pd.get_dummies(df[<span class="st">"ocean_proximity"</span>], prefix<span class="op">=</span><span class="st">'ocean_proximity'</span>)</span>
<span id="cb1-17"><a href=""></a>    <span class="co"># Join all the dataframes</span></span>
<span id="cb1-18"><a href=""></a>    <span class="cf">return</span> pd.concat([num_df, cat_df, df[[<span class="st">"median_house_value"</span>]]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-19"><a href=""></a></span>
<span id="cb1-20"><a href=""></a></span>
<span id="cb1-21"><a href=""></a>df <span class="op">=</span> preprocess()</span>
<span id="cb1-22"><a href=""></a>df</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">population_per_household</th>
<th data-quarto-table-cell-role="th">rooms_per_household</th>
<th data-quarto-table-cell-role="th">bedrooms_per_room</th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR OCEAN</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1.327803</td>
<td>1.052523</td>
<td>0.982119</td>
<td>-0.804800</td>
<td>-0.972453</td>
<td>-0.974405</td>
<td>-0.977009</td>
<td>2.344709</td>
<td>-0.049595</td>
<td>0.628544</td>
<td>-1.029963</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>452600.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.322812</td>
<td>1.043159</td>
<td>-0.607004</td>
<td>2.045841</td>
<td>1.357111</td>
<td>0.861418</td>
<td>1.669921</td>
<td>2.332181</td>
<td>-0.092510</td>
<td>0.327033</td>
<td>-0.888876</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>358500.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.332794</td>
<td>1.038478</td>
<td>1.856137</td>
<td>-0.535733</td>
<td>-0.827004</td>
<td>-0.820757</td>
<td>-0.843616</td>
<td>1.782656</td>
<td>-0.025842</td>
<td>1.155592</td>
<td>-1.291654</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>352100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.337785</td>
<td>1.038478</td>
<td>1.856137</td>
<td>-0.624199</td>
<td>-0.719706</td>
<td>-0.766010</td>
<td>-0.733764</td>
<td>0.932945</td>
<td>-0.050328</td>
<td>0.156962</td>
<td>-0.449602</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>341300.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.337785</td>
<td>1.038478</td>
<td>1.856137</td>
<td>-0.462393</td>
<td>-0.612408</td>
<td>-0.759828</td>
<td>-0.629142</td>
<td>-0.012881</td>
<td>-0.085614</td>
<td>0.344702</td>
<td>-0.639071</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>342200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20635</td>
<td>-0.758808</td>
<td>1.801603</td>
<td>-0.289180</td>
<td>-0.444974</td>
<td>-0.388274</td>
<td>-0.512579</td>
<td>-0.443438</td>
<td>-1.216099</td>
<td>-0.049109</td>
<td>-0.155020</td>
<td>0.165990</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>78100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20636</td>
<td>-0.818702</td>
<td>1.806285</td>
<td>-0.845373</td>
<td>-0.888682</td>
<td>-0.922380</td>
<td>-0.944382</td>
<td>-1.008396</td>
<td>-0.691576</td>
<td>0.005021</td>
<td>0.276874</td>
<td>0.021670</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>77100.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20637</td>
<td>-0.823693</td>
<td>1.778194</td>
<td>-0.924829</td>
<td>-0.174991</td>
<td>-0.123605</td>
<td>-0.369528</td>
<td>-0.174037</td>
<td>-1.142566</td>
<td>-0.071733</td>
<td>-0.090316</td>
<td>0.021134</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>92300.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20638</td>
<td>-0.873605</td>
<td>1.778194</td>
<td>-0.845373</td>
<td>-0.355591</td>
<td>-0.304820</td>
<td>-0.604415</td>
<td>-0.393743</td>
<td>-1.054557</td>
<td>-0.091223</td>
<td>-0.040210</td>
<td>0.093464</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>84700.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20639</td>
<td>-0.833676</td>
<td>1.750104</td>
<td>-1.004285</td>
<td>0.068407</td>
<td>0.188752</td>
<td>-0.033976</td>
<td>0.079670</td>
<td>-0.780111</td>
<td>-0.043681</td>
<td>-0.070441</td>
<td>0.113272</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>89400.0</td>
</tr>
</tbody>
</table>

<p>20640 rows × 17 columns</p>
</div>
</div>
</div>
</section></section>
<section id="checking-feature-correlations" class="title-slide slide level1 center">
<h1>Checking feature correlations</h1>
<div id="6UU4itaaW-pF" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:33.430990Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:33.430647Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:37.247858Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:37.247349Z&quot;}" data-outputid="9890e739-2566-4e8f-ca63-a1f515c047d6" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb2-1"><a href=""></a>sns.pairplot(</span>
<span id="cb2-2"><a href=""></a>    df[[<span class="st">"population_per_household"</span>, <span class="st">"rooms_per_household"</span>, <span class="st">"bedrooms_per_room"</span>, <span class="st">"median_house_value"</span>]].sample(n<span class="op">=</span><span class="dv">1000</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb2-3"><a href=""></a>    hue<span class="op">=</span><span class="st">'median_house_value'</span>, markers<span class="op">=</span><span class="st">'+'</span></span>
<span id="cb2-4"><a href=""></a>)</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-4-output-1.png" class="r-stretch"></section>

<section id="splitting-training-and-test-data" class="title-slide slide level1 center">
<h1>Splitting training and test data</h1>
<div id="09fe3dce" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:37.249792Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:37.249431Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:37.312931Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:37.312427Z&quot;}" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-2"><a href=""></a>y <span class="op">=</span> df[<span class="st">"median_house_value"</span>]  <span class="co"># labels</span></span>
<span id="cb3-3"><a href=""></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"median_house_value"</span>])  <span class="co"># input data</span></span>
<span id="cb3-4"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.33</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb3-5"><a href=""></a></span>
<span id="cb3-6"><a href=""></a><span class="bu">print</span>(<span class="ss">f"X_train: </span><span class="sc">{</span>X_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"X_test: </span><span class="sc">{</span>X_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-8"><a href=""></a><span class="bu">print</span>(<span class="ss">f"y_train: </span><span class="sc">{</span>y_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-9"><a href=""></a><span class="bu">print</span>(<span class="ss">f"y_test: </span><span class="sc">{</span>y_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X_train: (13828, 16)
X_test: (6812, 16)
y_train: (13828,)
y_test: (6812,)</code></pre>
</div>
</div>
<div id="613643ea" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:37.314747Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:37.314478Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:37.321832Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:37.321377Z&quot;}" data-outputid="a4442b92-29c4-4d21-c35d-448acb919b71" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb5-1"><a href=""></a>X_train.info()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 13828 entries, 5088 to 15795
Data columns (total 16 columns):
 #   Column                      Non-Null Count  Dtype  
---  ------                      --------------  -----  
 0   longitude                   13828 non-null  float64
 1   latitude                    13828 non-null  float64
 2   housing_median_age          13828 non-null  float64
 3   total_rooms                 13828 non-null  float64
 4   total_bedrooms              13828 non-null  float64
 5   population                  13828 non-null  float64
 6   households                  13828 non-null  float64
 7   median_income               13828 non-null  float64
 8   population_per_household    13828 non-null  float64
 9   rooms_per_household         13828 non-null  float64
 10  bedrooms_per_room           13828 non-null  float64
 11  ocean_proximity_&lt;1H OCEAN   13828 non-null  bool   
 12  ocean_proximity_INLAND      13828 non-null  bool   
 13  ocean_proximity_ISLAND      13828 non-null  bool   
 14  ocean_proximity_NEAR BAY    13828 non-null  bool   
 15  ocean_proximity_NEAR OCEAN  13828 non-null  bool   
dtypes: bool(5), float64(11)
memory usage: 1.3 MB</code></pre>
</div>
</div>
</section>

<section id="regression" class="title-slide slide level1 center">
<h1>Regression</h1>
<p>LinearRegression fits a linear model with coefficients <span class="math inline">\(w = (w_1, ..., w_p)\)</span> to minimize the residual sum of squares between the observed targets in the dataset, and the targets predicted by the linear approximation.</p>
<div id="805e7157" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:37.323624Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:37.323303Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:37.353998Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:37.353474Z&quot;}" data-outputid="8690e44b-d89e-441c-abb7-329217939c72" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression  <span class="co"># choose and import the model</span></span>
<span id="cb7-2"><a href=""></a>lin_reg <span class="op">=</span> LinearRegression(fit_intercept<span class="op">=</span><span class="va">True</span>)  <span class="co"># choose model hyperparameters and initialize the model (i.e., the estimator)</span></span>
<span id="cb7-3"><a href=""></a>lin_reg.fit(X_train, y_train)  <span class="co"># model fitting</span></span>
<span id="cb7-4"><a href=""></a>lin_reg.coef_  <span class="co"># return the learned parameters</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([-56678.25415922, -56570.43784763,  14012.48612813,   6065.60436301,
         7794.76152315, -44411.72364438,  36464.94733357,  78235.6199298 ,
          623.98096453,   7861.81047911,  18857.77231068, -22083.12212996,
       -57203.42335754, 126522.31313893, -28661.2527942 , -18574.51485723])</code></pre>
</div>
</div>
<div id="deb75fc9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:37.356189Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:37.355943Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:37.362074Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:37.361444Z&quot;}" data-outputid="240c7e9e-dfe4-4606-acca-09f86309f0a1" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb9-1"><a href=""></a>housing_predictions <span class="op">=</span> lin_reg.predict(X_test)  <span class="co"># predict the cost of the houses in the test set</span></span>
<span id="cb9-2"><a href=""></a>housing_predictions</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([ 62413.7678525 , 120560.31036082, 261786.7058476 , ...,
       109483.51261867, 126282.2974808 , 227980.65278688])</code></pre>
</div>
</div>

<img data-src="https://user-images.githubusercontent.com/18005592/232785531-1258fd6b-78a8-4f0a-9bde-bcc7f416f14f.png" class="r-stretch quarto-figure-center"><p class="caption">image</p></section>

<section id="measuring-performance" class="title-slide slide level1 center">
<h1>Measuring performance</h1>
<p>We are facing a <em>regression problem</em></p>
<ul>
<li>A typical performance measure for regression problems is the <em>Root Mean Square Error (RMSE)</em></li>
<li>RMSE is the standard deviation of the residuals (prediction errors)</li>
<li>Residuals measures how far from the regression line data points are; RMSE is a measure of how spread out these residuals are</li>
</ul>

<img data-src="https://user-images.githubusercontent.com/18005592/232786035-abaca941-12c5-44b0-9085-e9908512803d.png" class="r-stretch"></section>

<section id="computing-the-rmse" class="title-slide slide level1 center">
<h1>Computing the RMSE</h1>
<div id="a764f2b9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:37.364563Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:37.364244Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:37.553205Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:37.552756Z&quot;}" data-outputid="67c9d925-8b17-4d76-a6b5-b6afe9e27a99" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb11-1"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> root_mean_squared_error</span>
<span id="cb11-2"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb11-3"><a href=""></a></span>
<span id="cb11-4"><a href=""></a><span class="kw">def</span> plot_predictions(y_test, housing_predictions, show<span class="op">=</span><span class="dv">20</span>, accuracy<span class="op">=</span><span class="va">False</span>, plot<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb11-5"><a href=""></a>    <span class="cf">if</span> <span class="kw">not</span> accuracy:</span>
<span id="cb11-6"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"RMSE: </span><span class="sc">{</span>root_mean_squared_error(y_test, housing_predictions)<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># check the error</span></span>
<span id="cb11-7"><a href=""></a>    <span class="cf">else</span>:</span>
<span id="cb11-8"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, housing_predictions)<span class="sc">}</span><span class="ss">"</span>)  <span class="co"># check the error</span></span>
<span id="cb11-9"><a href=""></a>    <span class="cf">if</span> plot: pd.DataFrame({<span class="st">'y_test'</span>: y_test[:show].to_numpy(), <span class="st">'y_pred'</span>: housing_predictions[:show]}, index<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(show)]).plot.bar(rot<span class="op">=</span><span class="dv">0</span>)  <span class="co"># visualize some predictions</span></span>
<span id="cb11-10"><a href=""></a></span>
<span id="cb11-11"><a href=""></a>plot_predictions(y_test, housing_predictions)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 70532.346029265</code></pre>
</div>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-9-output-2.png" class="r-stretch"></section>

<section id="are-we-satisfied" class="title-slide slide level1 center">
<h1>Are we satisfied?</h1>
<p>This is better than nothing, but clearly not a great score: most districts’ <code>median_housing_values</code> range between 120K USD and 265K USD, so a typical prediction error of ~70K USD is not very satisfying.</p>
<p>This is an example of a model underfitting the training data.</p>
</section>

<section id="random-forest-regressor" class="title-slide slide level1 center">
<h1><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">Random forest regressor</a></h1>
<p>A random forest fits decision trees on sub-samples of the dataset and uses averaging to improve accuracy and control over-fitting.</p>
<p>The sample size is controlled with <code>max_samples</code> if <code>bootstrap=True</code>, otherwise the whole dataset is used to build each tree.</p>
<div id="109abc76" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:37.555210Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:37.554800Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:49.541845Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:49.541343Z&quot;}" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb13-1"><a href=""></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor  <span class="co"># import the model</span></span>
<span id="cb13-2"><a href=""></a></span>
<span id="cb13-3"><a href=""></a><span class="kw">def</span> run_forest(n_estimators, max_features, min_samples_split<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb13-4"><a href=""></a>    forest_reg <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span>n_estimators, max_features<span class="op">=</span>max_features, random_state<span class="op">=</span><span class="dv">42</span>, bootstrap<span class="op">=</span><span class="va">True</span>)  <span class="co"># initialize the model (i.e., the estimator)</span></span>
<span id="cb13-5"><a href=""></a>    forest_reg.fit(X_train, y_train)  <span class="co"># train it</span></span>
<span id="cb13-6"><a href=""></a>    housing_predictions <span class="op">=</span> forest_reg.predict(X_test)  <span class="co"># predict the cost of houses in the test set</span></span>
<span id="cb13-7"><a href=""></a>    plot_predictions(y_test, housing_predictions)</span>
<span id="cb13-8"><a href=""></a>    <span class="cf">return</span> forest_reg</span>
<span id="cb13-9"><a href=""></a></span>
<span id="cb13-10"><a href=""></a>forest_reg <span class="op">=</span> run_forest(<span class="dv">100</span>, <span class="fl">1.0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 50155.05753085368</code></pre>
</div>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-10-output-2.png" class="r-stretch"></section>

<section id="feature-importance" class="title-slide slide level1 center">
<h1>Feature importance</h1>
<div id="b45ae8cc" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:49.543587Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:49.543369Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:49.565103Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:49.564624Z&quot;}" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb15-1"><a href=""></a>feature_importance <span class="op">=</span> forest_reg.feature_importances_</span>
<span id="cb15-2"><a href=""></a>pd.DataFrame({<span class="st">'Feature'</span>: X_train.columns, <span class="st">'Importance'</span>: feature_importance}).sort_values(by<span class="op">=</span><span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>median_income</td>
<td>0.480348</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>ocean_proximity_INLAND</td>
<td>0.140681</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>population_per_household</td>
<td>0.121576</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>longitude</td>
<td>0.055974</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>latitude</td>
<td>0.052593</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>housing_median_age</td>
<td>0.046326</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>rooms_per_household</td>
<td>0.025822</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>bedrooms_per_room</td>
<td>0.024792</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>total_rooms</td>
<td>0.013021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>total_bedrooms</td>
<td>0.012122</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>population</td>
<td>0.011427</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>households</td>
<td>0.010476</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>ocean_proximity_NEAR OCEAN</td>
<td>0.002343</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>ocean_proximity_&lt;1H OCEAN</td>
<td>0.001246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>ocean_proximity_NEAR BAY</td>
<td>0.001033</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>ocean_proximity_ISLAND</td>
<td>0.000221</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="calculate-the-average-median_house_income-by-ocean_proximity" class="title-slide slide level1 center">
<h1>Calculate the average <code>median_house_income</code> by <code>ocean_proximity</code></h1>
<div id="b802bd3f" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:49.566790Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:49.566597Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:49.901420Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:49.900928Z&quot;}" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb16-1"><a href=""></a>cur_df <span class="op">=</span> preprocess(normalize<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb16-2"><a href=""></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-3"><a href=""></a><span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'INLAND'</span>, <span class="st">'NEAR OCEAN'</span>, <span class="st">'&lt;1H OCEAN'</span>, <span class="st">'ISLAND'</span>]):</span>
<span id="cb16-4"><a href=""></a>    cur_df.groupby(<span class="ss">f'ocean_proximity_</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">'</span>)[<span class="st">'median_house_value'</span>].mean().plot(kind<span class="op">=</span><span class="st">"bar"</span>, ax<span class="op">=</span>axs[i])</span>
<span id="cb16-5"><a href=""></a>fig.tight_layout()</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-12-output-1.png" class="r-stretch"></section>

<section id="hyperparameters" class="title-slide slide level1 center">
<h1>Hyperparameters</h1>
<p>Look at parameters used by our current forest</p>
<div id="f0235826" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:49.903281Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:49.902943Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:02:49.907145Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:02:49.906717Z&quot;}" data-outputid="ef64edc2-59a9-48a1-cb0d-08785ca187a8" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb17-1"><a href=""></a>forest_reg.get_params()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'criterion': 'squared_error',
 'max_depth': None,
 'max_features': 1.0,
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'monotonic_cst': None,
 'n_estimators': 100,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
</section>

<section id="hyperparameter-optimization-random-search" class="title-slide slide level1 center">
<h1>Hyperparameter optimization: random search</h1>
<div id="8d94f505" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:02:49.908857Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:02:49.908519Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:36.793426Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:36.792950Z&quot;}" data-outputid="e8ff8305-48f8-489a-9c30-5dff16650f1b" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb19-1"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb19-2"><a href=""></a></span>
<span id="cb19-3"><a href=""></a>random_grid <span class="op">=</span> {</span>
<span id="cb19-4"><a href=""></a>    <span class="st">'n_estimators'</span>: [<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>],  <span class="co"># Number of trees in random forest</span></span>
<span id="cb19-5"><a href=""></a>    <span class="st">'max_features'</span>: [<span class="fl">1.0</span>, <span class="st">'sqrt'</span>],  <span class="co"># Number of features to consider at every split</span></span>
<span id="cb19-6"><a href=""></a>    <span class="st">'min_samples_split'</span>: [<span class="dv">2</span>, <span class="dv">5</span>]</span>
<span id="cb19-7"><a href=""></a>}</span>
<span id="cb19-8"><a href=""></a></span>
<span id="cb19-9"><a href=""></a><span class="co"># Fit the random search model</span></span>
<span id="cb19-10"><a href=""></a>rf_random <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>forest_reg, param_distributions<span class="op">=</span>random_grid, n_iter<span class="op">=</span><span class="dv">5</span>, cv<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb19-11"><a href=""></a>rf_random.fit(X_train, y_train)</span>
<span id="cb19-12"><a href=""></a>rf_random.best_params_</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 5 candidates, totalling 15 fits
[CV] END max_features=1.0, min_samples_split=5, n_estimators=25; total time=   1.7s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=25; total time=   1.7s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=25; total time=   1.7s
[CV] END max_features=sqrt, min_samples_split=2, n_estimators=100; total time=   2.3s
[CV] END max_features=sqrt, min_samples_split=2, n_estimators=100; total time=   2.3s
[CV] END max_features=sqrt, min_samples_split=2, n_estimators=100; total time=   2.2s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=2; total time=   0.2s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=2; total time=   0.1s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=2; total time=   0.1s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=2; total time=   0.0s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=2; total time=   0.0s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=2; total time=   0.0s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=150; total time=  10.5s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=150; total time=  10.3s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=150; total time=  10.3s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>{'n_estimators': 100, 'min_samples_split': 2, 'max_features': 'sqrt'}</code></pre>
</div>
</div>
</section>

<section id="running-the-best-forest" class="title-slide slide level1 center">
<h1>Running the best forest</h1>
<div id="f40f18a9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:36.795318Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:36.794976Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:40.449849Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:40.449271Z&quot;}" data-outputid="28de0675-820b-49db-d617-d7ebb3936c17" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb22-1"><a href=""></a>forest<span class="op">=</span>run_forest(n_estimators<span class="op">=</span><span class="dv">100</span>, min_samples_split<span class="op">=</span><span class="dv">2</span>, max_features<span class="op">=</span><span class="st">'sqrt'</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 49296.853444113134</code></pre>
</div>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-15-output-2.png" class="r-stretch"></section>

<section id="dimensionality-reduction-pca" class="title-slide slide level1 center">
<h1>Dimensionality reduction: PCA</h1>
<div id="41167ddd" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:40.451622Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:40.451453Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:40.747098Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:40.746618Z&quot;}" data-outputid="3fd9659d-cbcb-4589-ff31-a5687caaaed2" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb24-1"><a href=""></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb24-2"><a href=""></a></span>
<span id="cb24-3"><a href=""></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-4"><a href=""></a>result_pca <span class="op">=</span> pca.fit_transform(X_train.values)</span>
<span id="cb24-5"><a href=""></a>plt.scatter(x<span class="op">=</span>result_pca[:, <span class="dv">0</span>], y<span class="op">=</span>result_pca[:, <span class="dv">1</span>], c<span class="op">=</span>y_train, s<span class="op">=</span><span class="dv">2</span>, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb24-6"><a href=""></a>pd.DataFrame(pca.components_, columns<span class="op">=</span>X_train.columns, index<span class="op">=</span>[<span class="st">'PC1'</span>, <span class="st">'PC2'</span>])</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">population_per_household</th>
<th data-quarto-table-cell-role="th">rooms_per_household</th>
<th data-quarto-table-cell-role="th">bedrooms_per_room</th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR OCEAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">PC1</td>
<td>0.067570</td>
<td>-0.064488</td>
<td>-0.218377</td>
<td>0.481213</td>
<td>0.491136</td>
<td>0.475472</td>
<td>0.491947</td>
<td>0.045903</td>
<td>-0.004028</td>
<td>0.007194</td>
<td>-0.011824</td>
<td>0.014685</td>
<td>0.001303</td>
<td>-0.000042</td>
<td>-0.013497</td>
<td>-0.002449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PC2</td>
<td>-0.593374</td>
<td>0.610175</td>
<td>-0.081621</td>
<td>0.108533</td>
<td>0.009148</td>
<td>-0.021333</td>
<td>0.004461</td>
<td>0.222566</td>
<td>0.008746</td>
<td>0.284716</td>
<td>-0.304254</td>
<td>-0.140430</td>
<td>0.082383</td>
<td>-0.000152</td>
<td>0.079831</td>
<td>-0.021631</td>
</tr>
</tbody>
</table>

</div>
</div>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-16-output-2.png" class="r-stretch"></section>

<section id="dimensionality-reduction-tsne" class="title-slide slide level1 center">
<h1>Dimensionality reduction: TSNE</h1>
<div id="HYDBmdVCXjFV" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:40.748962Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:40.748794Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:51.211087Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:51.210488Z&quot;}" data-outputid="8a922751-723f-41bf-989a-ba8c39e91498" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb25-1"><a href=""></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb25-2"><a href=""></a></span>
<span id="cb25-3"><a href=""></a>tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-4"><a href=""></a>result_tsne <span class="op">=</span> tsne.fit_transform(X_train.head(<span class="dv">3000</span>))</span>
<span id="cb25-5"><a href=""></a></span>
<span id="cb25-6"><a href=""></a>plt.scatter(x<span class="op">=</span>result_tsne[:, <span class="dv">0</span>], y<span class="op">=</span>result_tsne[:, <span class="dv">1</span>], c<span class="op">=</span>y_train.head(<span class="dv">3000</span>), s<span class="op">=</span><span class="dv">2</span>, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-17-output-1.png" class="r-stretch"></section>

<section id="classification" class="title-slide slide level1 center">
<h1>Classification</h1>
<p>Can we turn this into a classification problem?</p>
</section>

<section id="binning-the-median_house_value-into-3-classes" class="title-slide slide level1 center">
<h1>Binning the <code>median_house_value</code> into 3 classes</h1>
<div id="f16c0883" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:51.212972Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:51.212764Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:51.356388Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:51.355820Z&quot;}" data-outputid="049fe2a8-9c8f-4064-cc3b-f991f465a2bb" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb26-1"><a href=""></a>df <span class="op">=</span> preprocess(<span class="va">False</span>)  <span class="co"># clean the dataset withtout standardization</span></span>
<span id="cb26-2"><a href=""></a>bins <span class="op">=</span> [<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>]  <span class="co"># the labels we are gonna use</span></span>
<span id="cb26-3"><a href=""></a><span class="co"># map bins of values into labels</span></span>
<span id="cb26-4"><a href=""></a>df[<span class="st">"median_house_value"</span>] <span class="op">=</span> pd.cut(df[<span class="st">"median_house_value"</span>], <span class="dv">3</span>, labels<span class="op">=</span>bins)</span>
<span id="cb26-5"><a href=""></a>df[<span class="st">"median_house_value"</span>].hist()  <span class="co"># plot them</span></span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-18-output-1.png" class="r-stretch"></section>

<section id="feature-selection" class="title-slide slide level1 center">
<h1>Feature selection</h1>
<p>For the sake of performance, we are going to use a manually defined set of features</p>
<div id="eafc83b9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:51.358522Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:51.358040Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:51.363096Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:51.362660Z&quot;}" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb27-1"><a href=""></a>y <span class="op">=</span> df[<span class="st">"median_house_value"</span>]  <span class="co"># labels</span></span>
<span id="cb27-2"><a href=""></a><span class="co"># consider only some features from the train dataset</span></span>
<span id="cb27-3"><a href=""></a>X <span class="op">=</span> df[[<span class="st">"latitude"</span>, <span class="st">"longitude"</span>, <span class="st">"median_income"</span>, <span class="st">"population"</span>, <span class="st">"households"</span>, <span class="st">"total_bedrooms"</span>]]</span>
<span id="cb27-4"><a href=""></a><span class="co"># split the dataset</span></span>
<span id="cb27-5"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.33</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</details>
</div>
</section>

<section id="pca" class="title-slide slide level1 center">
<h1>PCA</h1>
<div id="ae91e744" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:51.364821Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:51.364509Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:03:51.744745Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:03:51.744180Z&quot;}" data-execution_count="19">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb28-1"><a href=""></a>result_pca <span class="op">=</span> pca.fit_transform(X_train.values)</span>
<span id="cb28-2"><a href=""></a><span class="kw">def</span> color(x):</span>
<span id="cb28-3"><a href=""></a>    <span class="cf">if</span> x <span class="op">==</span> <span class="st">"low"</span>: <span class="cf">return</span> <span class="st">"tab:blue"</span></span>
<span id="cb28-4"><a href=""></a>    <span class="cf">elif</span> x <span class="op">==</span> <span class="st">"medium"</span>: <span class="cf">return</span> <span class="st">"tab:orange"</span></span>
<span id="cb28-5"><a href=""></a>    <span class="cf">else</span>: <span class="cf">return</span> <span class="st">"tab:red"</span></span>
<span id="cb28-6"><a href=""></a>plt.scatter(x<span class="op">=</span>result_pca[:, <span class="dv">0</span>], y<span class="op">=</span>result_pca[:, <span class="dv">1</span>], c<span class="op">=</span>y_train.<span class="bu">apply</span>(color), s<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-20-output-1.png" class="r-stretch"></section>

<section id="tsne" class="title-slide slide level1 center">
<h1>TSNE</h1>
<div id="7c2620f8" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:03:51.746633Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:03:51.746454Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:02.864559Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:02.864081Z&quot;}" data-execution_count="20">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb29-1"><a href=""></a>tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-2"><a href=""></a>result_tsne <span class="op">=</span> tsne.fit_transform(X_train.head(<span class="dv">3000</span>))</span>
<span id="cb29-3"><a href=""></a>plt.scatter(x<span class="op">=</span>result_tsne[:, <span class="dv">0</span>], y<span class="op">=</span>result_tsne[:, <span class="dv">1</span>], c<span class="op">=</span>y_train.head(<span class="dv">3000</span>).<span class="bu">apply</span>(color), s<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-21-output-1.png" class="r-stretch"></section>

<section id="computing-performance" class="title-slide slide level1 center">
<h1>Computing performance</h1>
<div class="columns">
<div class="column" style="width:70%;">
<p><img data-src="https://user-images.githubusercontent.com/18005592/232803278-7a0e5182-4267-410a-a809-7edc54a47980.png"></p>
</div><div class="column" style="width:30%;">
<p><img data-src="https://user-images.githubusercontent.com/18005592/232803261-1cae7aac-e3fc-4467-bb45-65455d7a34a7.png"></p>
</div>
</div>
<p>Accuracy: <span class="math inline">\(\frac{tp + tn}{tp + tn + fp + fpn}\)</span>; Precision: <span class="math inline">\(\frac{tp}{tp + fp}\)</span>; Recall: <span class="math inline">\(\frac{tp}{tp + fn}\)</span>; F1-score: <span class="math inline">\(2 \cdot \frac{precision \cdot recall}{precision + recall}\)</span></p>
<ul>
<li>Accuracy is used when TP and TN are more important while F1-score is used when FN and FP are</li>
<li>Accuracy can be used when the class distribution is similar, while F1-score is a better when there are imbalanced classes</li>
</ul>
</section>

<section id="decision-tree" class="title-slide slide level1 center">
<h1>Decision tree</h1>
<div id="f6a910d0" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:02.866557Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:02.866244Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:02.989176Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:02.988623Z&quot;}" data-outputid="82053cf2-a092-429d-ecb4-d43592966a25" data-execution_count="21">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb30-1"><a href=""></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb30-2"><a href=""></a></span>
<span id="cb30-3"><a href=""></a>clf <span class="op">=</span> tree.DecisionTreeClassifier(criterion<span class="op">=</span><span class="st">"entropy"</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb30-4"><a href=""></a>clf <span class="op">=</span> clf.fit(X_train, y_train)</span>
<span id="cb30-5"><a href=""></a>housing_predictions <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb30-6"><a href=""></a>plot_predictions(y_test, housing_predictions, accuracy<span class="op">=</span><span class="va">True</span>, plot<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.768349970640047</code></pre>
</div>
</div>
<div id="0a816a7f" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:02.990992Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:02.990658Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:03.103120Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:03.102571Z&quot;}" data-outputid="2e6106d2-46a7-4a47-ed82-5e4ea92d1c6c" data-execution_count="22">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb32-1"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb32-2"><a href=""></a></span>
<span id="cb32-3"><a href=""></a><span class="bu">print</span>(classification_report(y_test, housing_predictions, target_names<span class="op">=</span>bins))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

         low       0.67      0.70      0.68       958
      medium       0.84      0.84      0.84      3303
        high       0.71      0.70      0.70      2551

    accuracy                           0.77      6812
   macro avg       0.74      0.75      0.74      6812
weighted avg       0.77      0.77      0.77      6812
</code></pre>
</div>
</div>
<div id="ec492de6" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:03.104919Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:03.104601Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:03.111098Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:03.110634Z&quot;}" data-execution_count="23">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb34-1"><a href=""></a>feature_importance <span class="op">=</span> clf.feature_importances_</span>
<span id="cb34-2"><a href=""></a>pd.DataFrame({<span class="st">'Feature'</span>: X_train.columns,<span class="st">'Importance'</span>: feature_importance}).sort_values(by<span class="op">=</span><span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>median_income</td>
<td>0.337024</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>longitude</td>
<td>0.254091</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>latitude</td>
<td>0.211648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>population</td>
<td>0.072762</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>total_bedrooms</td>
<td>0.071925</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>households</td>
<td>0.052550</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="plotting-the-tree" class="title-slide slide level1 center">
<h1>Plotting the tree</h1>
<div id="017f3c68" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:03.112972Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:03.112483Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:04.204626Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:04.204044Z&quot;}" data-outputid="68f262ca-ef73-4f29-9af9-2f6e010b4659" data-execution_count="24">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb35-1"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">12</span>))</span>
<span id="cb35-2"><a href=""></a>tree <span class="op">=</span> tree.plot_tree(clf, fontsize<span class="op">=</span><span class="dv">10</span>, feature_names<span class="op">=</span>X_train.columns, class_names<span class="op">=</span>bins, max_depth<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-25-output-1.png" class="r-stretch"></section>

<section id="random-forest" class="title-slide slide level1 center">
<h1>Random forest</h1>
<div id="zgtE_hRwXpWj" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:04.206657Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:04.206313Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:07.024099Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:07.023580Z&quot;}" data-outputid="8744a206-7a5a-4625-8927-e1118481dcea" data-execution_count="25">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb36-1"><a href=""></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb36-2"><a href=""></a></span>
<span id="cb36-3"><a href=""></a>forest_cls <span class="op">=</span> RandomForestClassifier(criterion<span class="op">=</span><span class="st">"entropy"</span>, random_state<span class="op">=</span><span class="dv">42</span>) <span class="co"># initialize the model</span></span>
<span id="cb36-4"><a href=""></a>forest_cls <span class="op">=</span> forest_cls.fit(X_train, y_train) <span class="co"># train it</span></span>
<span id="cb36-5"><a href=""></a>plot_predictions(y_test, forest_cls.predict(X_test), accuracy<span class="op">=</span><span class="va">True</span>, plot<span class="op">=</span><span class="va">False</span>) <span class="co"># check the error</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.8247210804462712</code></pre>
</div>
</div>
<div id="oXKGFKaUXriL" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:07.025756Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:07.025574Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:07.029661Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:07.029230Z&quot;}" data-outputid="f8a1ee63-8169-46e4-ab6b-cc58fd0ec666" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb38-1"><a href=""></a>forest_cls.get_params()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'entropy',
 'max_depth': None,
 'max_features': 'sqrt',
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'monotonic_cst': None,
 'n_estimators': 100,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
</section>

<section id="hyperparameter-optimization" class="title-slide slide level1 center">
<h1>Hyperparameter optimization</h1>
<div id="iJNLDjRuXtv0" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:07.031156Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:07.031011Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:37.014143Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:37.013680Z&quot;}" data-outputid="72c212c8-fc8d-4a4b-fc20-f915f86e4d3f" data-execution_count="27">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb40-1"><a href=""></a>random_grid <span class="op">=</span> {<span class="st">'n_estimators'</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>], <span class="co"># Number of trees in random forest</span></span>
<span id="cb40-2"><a href=""></a>               <span class="st">'max_features'</span>: [<span class="fl">1.0</span>, <span class="st">'sqrt'</span>], <span class="co"># Number of features to consider at every split</span></span>
<span id="cb40-3"><a href=""></a>               <span class="st">'min_samples_leaf'</span>: [<span class="dv">1</span>, <span class="dv">5</span>],</span>
<span id="cb40-4"><a href=""></a>               <span class="st">'max_depth'</span>: [<span class="dv">2</span>, <span class="dv">5</span>]</span>
<span id="cb40-5"><a href=""></a>              }</span>
<span id="cb40-6"><a href=""></a></span>
<span id="cb40-7"><a href=""></a>rf_random <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>forest_cls, param_distributions<span class="op">=</span>random_grid, cv<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb40-8"><a href=""></a>rf_random.fit(X_train, y_train)</span>
<span id="cb40-9"><a href=""></a>rf_random.best_params_</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 10 candidates, totalling 30 fits
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=1, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=1, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=1, n_estimators=150; total time=   0.6s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=5, n_estimators=100; total time=   2.1s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=5, n_estimators=100; total time=   2.1s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=5, n_estimators=100; total time=   2.1s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.2s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.2s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.2s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   2.1s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   2.1s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   2.1s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   0.9s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   0.9s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   0.9s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.4s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=5, n_estimators=150; total time=   1.3s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=5, n_estimators=150; total time=   1.3s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=5, n_estimators=150; total time=   1.3s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>{'n_estimators': 100,
 'min_samples_leaf': 1,
 'max_features': 1.0,
 'max_depth': 5}</code></pre>
</div>
</div>
</section>

<section id="running-the-best-forest-1" class="title-slide slide level1 center">
<h1>Running the “best” forest</h1>
<div id="Prs9v1QQXvbo" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:37.016122Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:37.015786Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:37.488178Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:37.487677Z&quot;}" data-outputid="fc61d6be-42bc-4eb8-8d91-5394c252c714" data-execution_count="28">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb43-1"><a href=""></a>forest_cls <span class="op">=</span> RandomForestClassifier(criterion<span class="op">=</span><span class="st">"gini"</span>, random_state<span class="op">=</span><span class="dv">42</span>, n_estimators<span class="op">=</span><span class="dv">50</span>, max_features<span class="op">=</span><span class="st">"sqrt"</span>, min_samples_leaf<span class="op">=</span><span class="dv">1</span>, max_depth<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb43-2"><a href=""></a>forest_cls <span class="op">=</span> forest_cls.fit(X_train, y_train) <span class="co"># train it</span></span>
<span id="cb43-3"><a href=""></a>plot_predictions(y_test, forest_cls.predict(X_test), accuracy<span class="op">=</span><span class="va">True</span>, plot<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.7298884321785085</code></pre>
</div>
</div>
<div id="1Wr3yNmyXxE8" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:37.489675Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:37.489523Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:37.493387Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:37.492849Z&quot;}" data-outputid="937a6ff7-345d-4b67-e480-49b65e761dff" data-execution_count="29">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb45-1"><a href=""></a>forest_cls.get_params()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'gini',
 'max_depth': 5,
 'max_features': 'sqrt',
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'monotonic_cst': None,
 'n_estimators': 50,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
</section>

<section id="automl-with-flaml" class="title-slide slide level1 center">
<h1>AutoML with <a href="https://microsoft.github.io/FLAML/docs/reference/automl/automl#automl-objects">FLAML</a></h1>
<div id="13d88cfc" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:37.495160Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:37.494859Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:04:37.502389Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:04:37.501915Z&quot;}" data-outputid="320b4213-5797-4338-f51b-16a82636b439" data-execution_count="30">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb47-1"><a href=""></a>scale_mapper <span class="op">=</span> {<span class="st">"low"</span>: <span class="dv">1</span>, <span class="st">"medium"</span>: <span class="dv">2</span>, <span class="st">"high"</span>: <span class="dv">3</span>}</span>
<span id="cb47-2"><a href=""></a>y_train <span class="op">=</span> y_train.replace(scale_mapper)</span>
<span id="cb47-3"><a href=""></a>y_test <span class="op">=</span> y_test.replace(scale_mapper)</span>
<span id="cb47-4"><a href=""></a>y_train</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>5088     1
17096    3
5617     2
20060    1
895      2
        ..
11284    2
11964    1
5390     2
860      2
15795    2
Name: median_house_value, Length: 13828, dtype: category
Categories (3, int64): [1 &lt; 2 &lt; 3]</code></pre>
</div>
</div>
</section>

<section id="running-automl" class="title-slide slide level1 center">
<h1>Running AutoML</h1>
<div id="1898d4d7" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:04:37.503926Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:04:37.503767Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:05:38.502954Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:05:38.502485Z&quot;}" data-outputid="67453331-b383-437a-d618-c8e747d50d1b" data-execution_count="31">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb49-1"><a href=""></a><span class="im">from</span> flaml <span class="im">import</span> AutoML</span>
<span id="cb49-2"><a href=""></a></span>
<span id="cb49-3"><a href=""></a>automl_settings <span class="op">=</span> {</span>
<span id="cb49-4"><a href=""></a>    <span class="st">"time_budget"</span>: <span class="dv">60</span>,  <span class="co"># in seconds</span></span>
<span id="cb49-5"><a href=""></a>    <span class="st">"metric"</span>: <span class="st">"accuracy"</span>,</span>
<span id="cb49-6"><a href=""></a>    <span class="st">"task"</span>: <span class="st">"classification"</span>,</span>
<span id="cb49-7"><a href=""></a>}</span>
<span id="cb49-8"><a href=""></a></span>
<span id="cb49-9"><a href=""></a>automl <span class="op">=</span> AutoML()</span>
<span id="cb49-10"><a href=""></a>automl.fit(X_train, y_train, <span class="op">**</span>automl_settings)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[flaml.automl.logger: 12-04 16:04:37] {1728} INFO - task = classification
[flaml.automl.logger: 12-04 16:04:37] {1739} INFO - Evaluation method: cv
[flaml.automl.logger: 12-04 16:04:37] {1838} INFO - Minimizing error metric: 1-accuracy
[flaml.automl.logger: 12-04 16:04:37] {1955} INFO - List of ML learners in AutoML Run: ['lgbm', 'rf', 'xgboost', 'extra_tree', 'xgb_limitdepth', 'sgd', 'lrl1']
[flaml.automl.logger: 12-04 16:04:37] {2258} INFO - iteration 0, current learner lgbm
[flaml.automl.logger: 12-04 16:04:37] {2393} INFO - Estimated sufficient time budget=1372s. Estimated necessary time budget=32s.
[flaml.automl.logger: 12-04 16:04:37] {2442} INFO -  at 0.2s,   estimator lgbm's best error=0.3435, best estimator lgbm's best error=0.3435
[flaml.automl.logger: 12-04 16:04:37] {2258} INFO - iteration 1, current learner lgbm
[flaml.automl.logger: 12-04 16:04:37] {2442} INFO -  at 0.2s,   estimator lgbm's best error=0.3435, best estimator lgbm's best error=0.3435
[flaml.automl.logger: 12-04 16:04:37] {2258} INFO - iteration 2, current learner lgbm
[flaml.automl.logger: 12-04 16:04:37] {2442} INFO -  at 0.3s,   estimator lgbm's best error=0.3199, best estimator lgbm's best error=0.3199
[flaml.automl.logger: 12-04 16:04:37] {2258} INFO - iteration 3, current learner sgd
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 0.7s,   estimator sgd's best error=0.5093,  best estimator lgbm's best error=0.3199
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 4, current learner lgbm
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 0.8s,   estimator lgbm's best error=0.2283, best estimator lgbm's best error=0.2283
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 5, current learner lgbm
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 0.9s,   estimator lgbm's best error=0.2283, best estimator lgbm's best error=0.2283
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 6, current learner lgbm
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 1.0s,   estimator lgbm's best error=0.2081, best estimator lgbm's best error=0.2081
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 7, current learner lgbm
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 1.1s,   estimator lgbm's best error=0.2081, best estimator lgbm's best error=0.2081
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 8, current learner lgbm
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 1.2s,   estimator lgbm's best error=0.2081, best estimator lgbm's best error=0.2081
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 9, current learner lgbm
[flaml.automl.logger: 12-04 16:04:38] {2442} INFO -  at 1.4s,   estimator lgbm's best error=0.1994, best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:38] {2258} INFO - iteration 10, current learner xgboost
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 1.5s,   estimator xgboost's best error=0.3410,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 11, current learner xgboost
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 1.6s,   estimator xgboost's best error=0.3002,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 12, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 1.7s,   estimator extra_tree's best error=0.3828,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 13, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 1.9s,   estimator extra_tree's best error=0.3687,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 14, current learner rf
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 2.1s,   estimator rf's best error=0.3757,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 15, current learner rf
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 2.3s,   estimator rf's best error=0.3132,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 16, current learner xgboost
[flaml.automl.logger: 12-04 16:04:39] {2442} INFO -  at 2.4s,   estimator xgboost's best error=0.3002,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:39] {2258} INFO - iteration 17, current learner lgbm
[flaml.automl.logger: 12-04 16:04:40] {2442} INFO -  at 2.5s,   estimator lgbm's best error=0.1994, best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:40] {2258} INFO - iteration 18, current learner sgd
[flaml.automl.logger: 12-04 16:04:40] {2442} INFO -  at 3.1s,   estimator sgd's best error=0.4913,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 12-04 16:04:40] {2258} INFO - iteration 19, current learner lgbm
[flaml.automl.logger: 12-04 16:04:41] {2442} INFO -  at 4.0s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:41] {2258} INFO - iteration 20, current learner xgboost
[flaml.automl.logger: 12-04 16:04:41] {2442} INFO -  at 4.1s,   estimator xgboost's best error=0.2881,  best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:41] {2258} INFO - iteration 21, current learner rf
[flaml.automl.logger: 12-04 16:04:41] {2442} INFO -  at 4.2s,   estimator rf's best error=0.3132,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:41] {2258} INFO - iteration 22, current learner rf
[flaml.automl.logger: 12-04 16:04:42] {2442} INFO -  at 4.5s,   estimator rf's best error=0.3132,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:42] {2258} INFO - iteration 23, current learner lgbm
[flaml.automl.logger: 12-04 16:04:43] {2442} INFO -  at 6.1s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:43] {2258} INFO - iteration 24, current learner lgbm
[flaml.automl.logger: 12-04 16:04:44] {2442} INFO -  at 6.7s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:44] {2258} INFO - iteration 25, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:44] {2442} INFO -  at 6.9s,   estimator extra_tree's best error=0.3687,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:44] {2258} INFO - iteration 26, current learner sgd
[flaml.automl.logger: 12-04 16:04:44] {2442} INFO -  at 7.1s,   estimator sgd's best error=0.4913,  best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:44] {2258} INFO - iteration 27, current learner lgbm
[flaml.automl.logger: 12-04 16:04:45] {2442} INFO -  at 7.9s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:45] {2258} INFO - iteration 28, current learner xgboost
[flaml.automl.logger: 12-04 16:04:45] {2442} INFO -  at 8.0s,   estimator xgboost's best error=0.2738,  best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:45] {2258} INFO - iteration 29, current learner xgboost
[flaml.automl.logger: 12-04 16:04:45] {2442} INFO -  at 8.1s,   estimator xgboost's best error=0.2738,  best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:45] {2258} INFO - iteration 30, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:45] {2442} INFO -  at 8.3s,   estimator extra_tree's best error=0.3687,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 12-04 16:04:45] {2258} INFO - iteration 31, current learner lgbm
[flaml.automl.logger: 12-04 16:04:47] {2442} INFO -  at 9.6s,   estimator lgbm's best error=0.1647, best estimator lgbm's best error=0.1647
[flaml.automl.logger: 12-04 16:04:47] {2258} INFO - iteration 32, current learner lgbm
[flaml.automl.logger: 12-04 16:04:50] {2442} INFO -  at 12.9s,  estimator lgbm's best error=0.1647, best estimator lgbm's best error=0.1647
[flaml.automl.logger: 12-04 16:04:50] {2258} INFO - iteration 33, current learner lgbm
[flaml.automl.logger: 12-04 16:04:51] {2442} INFO -  at 13.6s,  estimator lgbm's best error=0.1647, best estimator lgbm's best error=0.1647
[flaml.automl.logger: 12-04 16:04:51] {2258} INFO - iteration 34, current learner xgboost
[flaml.automl.logger: 12-04 16:04:51] {2442} INFO -  at 13.7s,  estimator xgboost's best error=0.2738,  best estimator lgbm's best error=0.1647
[flaml.automl.logger: 12-04 16:04:51] {2258} INFO - iteration 35, current learner lgbm
[flaml.automl.logger: 12-04 16:04:54] {2442} INFO -  at 17.2s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:54] {2258} INFO - iteration 36, current learner rf
[flaml.automl.logger: 12-04 16:04:55] {2442} INFO -  at 17.5s,  estimator rf's best error=0.2894,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:55] {2258} INFO - iteration 37, current learner sgd
[flaml.automl.logger: 12-04 16:04:55] {2442} INFO -  at 17.7s,  estimator sgd's best error=0.4913,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:55] {2258} INFO - iteration 38, current learner xgboost
[flaml.automl.logger: 12-04 16:04:55] {2442} INFO -  at 17.8s,  estimator xgboost's best error=0.2738,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:55] {2258} INFO - iteration 39, current learner xgboost
[flaml.automl.logger: 12-04 16:04:55] {2442} INFO -  at 17.9s,  estimator xgboost's best error=0.2738,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:55] {2258} INFO - iteration 40, current learner rf
[flaml.automl.logger: 12-04 16:04:55] {2442} INFO -  at 18.2s,  estimator rf's best error=0.2894,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:55] {2258} INFO - iteration 41, current learner xgboost
[flaml.automl.logger: 12-04 16:04:55] {2442} INFO -  at 18.4s,  estimator xgboost's best error=0.2565,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:55] {2258} INFO - iteration 42, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:56] {2442} INFO -  at 18.5s,  estimator extra_tree's best error=0.3272,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:56] {2258} INFO - iteration 43, current learner lgbm
[flaml.automl.logger: 12-04 16:04:57] {2442} INFO -  at 19.9s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:57] {2258} INFO - iteration 44, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:57] {2442} INFO -  at 20.1s,  estimator extra_tree's best error=0.3207,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:57] {2258} INFO - iteration 45, current learner sgd
[flaml.automl.logger: 12-04 16:04:58] {2442} INFO -  at 20.5s,  estimator sgd's best error=0.4907,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:58] {2258} INFO - iteration 46, current learner xgboost
[flaml.automl.logger: 12-04 16:04:58] {2442} INFO -  at 20.6s,  estimator xgboost's best error=0.2565,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:58] {2258} INFO - iteration 47, current learner rf
[flaml.automl.logger: 12-04 16:04:58] {2442} INFO -  at 20.8s,  estimator rf's best error=0.2746,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:58] {2258} INFO - iteration 48, current learner extra_tree
[flaml.automl.logger: 12-04 16:04:58] {2442} INFO -  at 21.0s,  estimator extra_tree's best error=0.3207,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:04:58] {2258} INFO - iteration 49, current learner lgbm
[flaml.automl.logger: 12-04 16:05:00] {2442} INFO -  at 22.5s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:05:00] {2258} INFO - iteration 50, current learner rf
[flaml.automl.logger: 12-04 16:05:00] {2442} INFO -  at 22.9s,  estimator rf's best error=0.2451,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:05:00] {2258} INFO - iteration 51, current learner xgboost
[flaml.automl.logger: 12-04 16:05:00] {2442} INFO -  at 23.1s,  estimator xgboost's best error=0.2565,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:05:00] {2258} INFO - iteration 52, current learner rf
[flaml.automl.logger: 12-04 16:05:00] {2442} INFO -  at 23.4s,  estimator rf's best error=0.2451,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:05:00] {2258} INFO - iteration 53, current learner rf
[flaml.automl.logger: 12-04 16:05:01] {2442} INFO -  at 23.8s,  estimator rf's best error=0.2451,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:05:01] {2258} INFO - iteration 54, current learner lgbm
[flaml.automl.logger: 12-04 16:05:11] {2442} INFO -  at 33.5s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 12-04 16:05:11] {2258} INFO - iteration 55, current learner lgbm
[flaml.automl.logger: 12-04 16:05:15] {2442} INFO -  at 38.4s,  estimator lgbm's best error=0.1640, best estimator lgbm's best error=0.1640
[flaml.automl.logger: 12-04 16:05:15] {2258} INFO - iteration 56, current learner xgboost
[flaml.automl.logger: 12-04 16:05:16] {2442} INFO -  at 38.6s,  estimator xgboost's best error=0.2406,  best estimator lgbm's best error=0.1640
[flaml.automl.logger: 12-04 16:05:16] {2258} INFO - iteration 57, current learner rf
[flaml.automl.logger: 12-04 16:05:16] {2442} INFO -  at 39.1s,  estimator rf's best error=0.2155,   best estimator lgbm's best error=0.1640
[flaml.automl.logger: 12-04 16:05:16] {2258} INFO - iteration 58, current learner rf
[flaml.automl.logger: 12-04 16:05:16] {2442} INFO -  at 39.4s,  estimator rf's best error=0.2155,   best estimator lgbm's best error=0.1640
[flaml.automl.logger: 12-04 16:05:16] {2258} INFO - iteration 59, current learner rf
[flaml.automl.logger: 12-04 16:05:17] {2442} INFO -  at 40.2s,  estimator rf's best error=0.1994,   best estimator lgbm's best error=0.1640
[flaml.automl.logger: 12-04 16:05:17] {2258} INFO - iteration 60, current learner lgbm
[flaml.automl.logger: 12-04 16:05:21] {2442} INFO -  at 43.6s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:21] {2258} INFO - iteration 61, current learner rf
[flaml.automl.logger: 12-04 16:05:21] {2442} INFO -  at 44.1s,  estimator rf's best error=0.1994,   best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:21] {2258} INFO - iteration 62, current learner lgbm
[flaml.automl.logger: 12-04 16:05:24] {2442} INFO -  at 46.7s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:24] {2258} INFO - iteration 63, current learner rf
[flaml.automl.logger: 12-04 16:05:25] {2442} INFO -  at 48.1s,  estimator rf's best error=0.1994,   best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:25] {2258} INFO - iteration 64, current learner xgboost
[flaml.automl.logger: 12-04 16:05:25] {2442} INFO -  at 48.2s,  estimator xgboost's best error=0.2108,  best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:25] {2258} INFO - iteration 65, current learner lgbm
[flaml.automl.logger: 12-04 16:05:31] {2442} INFO -  at 53.5s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:31] {2258} INFO - iteration 66, current learner xgboost
[flaml.automl.logger: 12-04 16:05:31] {2442} INFO -  at 53.8s,  estimator xgboost's best error=0.2108,  best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:31] {2258} INFO - iteration 67, current learner xgboost
[flaml.automl.logger: 12-04 16:05:31] {2442} INFO -  at 53.9s,  estimator xgboost's best error=0.2108,  best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:31] {2258} INFO - iteration 68, current learner xgboost
[flaml.automl.logger: 12-04 16:05:31] {2442} INFO -  at 54.3s,  estimator xgboost's best error=0.1996,  best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:31] {2258} INFO - iteration 69, current learner lgbm
[flaml.automl.logger: 12-04 16:05:37] {2442} INFO -  at 60.2s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 12-04 16:05:38] {2685} INFO - retrain lgbm for 0.7s
[flaml.automl.logger: 12-04 16:05:38] {2688} INFO - retrained model: LGBMClassifier(colsample_bytree=np.float64(0.6782006405163307),
               learning_rate=np.float64(0.08222714104485472), max_bin=511,
               min_child_samples=5, n_estimators=44, n_jobs=-1, num_leaves=254,
               reg_alpha=np.float64(0.003934614746573571),
               reg_lambda=np.float64(0.003560646472734122), verbose=-1)
[flaml.automl.logger: 12-04 16:05:38] {1985} INFO - fit succeeded
[flaml.automl.logger: 12-04 16:05:38] {1986} INFO - Time taken to find the best model: 43.607221841812134</code></pre>
</div>
</div>
</section>

<section id="running-the-best-model" class="title-slide slide level1 center">
<h1>Running the best model</h1>
<div id="8f9415cc" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:05:38.504848Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:05:38.504462Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:05:38.509728Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:05:38.509172Z&quot;}" data-outputid="29cb1af8-ff84-4d3a-9777-b53de04f264b" data-execution_count="32">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb51-1"><a href=""></a>automl.model.estimator</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LGBMClassifier(colsample_bytree=np.float64(0.6782006405163307),
               learning_rate=np.float64(0.08222714104485472), max_bin=511,
               min_child_samples=5, n_estimators=44, n_jobs=-1, num_leaves=254,
               reg_alpha=np.float64(0.003934614746573571),
               reg_lambda=np.float64(0.003560646472734122), verbose=-1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LGBMClassifier<span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LGBMClassifier(colsample_bytree=np.float64(0.6782006405163307),
               learning_rate=np.float64(0.08222714104485472), max_bin=511,
               min_child_samples=5, n_estimators=44, n_jobs=-1, num_leaves=254,
               reg_alpha=np.float64(0.003934614746573571),
               reg_lambda=np.float64(0.003560646472734122), verbose=-1)</pre></div> </div></div></div></div>
</div>
</div>
<div id="6b21842b" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:05:38.511518Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:05:38.511193Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:05:38.550557Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:05:38.550079Z&quot;}" data-outputid="552ae0e5-5a1e-49fe-eba5-1bdc54fc0319" data-execution_count="33">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb52-1"><a href=""></a>housing_predictions <span class="op">=</span> automl.predict(X_test)</span>
<span id="cb52-2"><a href=""></a>plot_predictions(y_test, housing_predictions, accuracy<span class="op">=</span><span class="va">True</span>, plot<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.8460070463887258</code></pre>
</div>
</div>
</section>

<section id="exercise" class="title-slide slide level1 center">
<h1>Exercise</h1>
<div id="571b733a" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-12-04T16:05:38.552709Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-12-04T16:05:38.552518Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-12-04T16:05:38.555590Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-12-04T16:05:38.555152Z&quot;}" data-execution_count="34">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb54-1"><a href=""></a><span class="co"># Can you do better?</span></span></code></pre></div>
</details>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Matteo Francia - Machine Learning and Data Mining (Module 2) - A.Y. 2024/25</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lab-06-housing_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lab-06-housing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lab-06-housing_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1100,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>