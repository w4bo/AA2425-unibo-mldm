<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="lab-06-housing_files/libs/quarto-html/tabby.min.js"></script>
<script src="lab-06-housing_files/libs/quarto-html/popper.min.js"></script>
<script src="lab-06-housing_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lab-06-housing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab-06-housing_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lab-06-housing_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lab-06-housing_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <title>lab-06-housing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lab-06-housing_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lab-06-housing_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lab-06-housing_files/libs/revealjs/dist/theme/quarto.css">
  <link href="lab-06-housing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lab-06-housing_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section class="slide level2">

<p><a href="https://colab.research.google.com/github/w4bo/AA2425-unibo-mldm/blob/master/slides/lab-06-housing.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
</section>
<section>
<section id="the-california-housing-case-study" class="title-slide slide level1 center">
<h1>The <a href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/"><code>California Housing</code></a> case study</h1>
<p>Our task is to use California census data to forecast housing prices given the population, median income, and median housing price for each block group in California. Block groups are the smallest geographical unit for which the US Census Bureau publishes sample data (a block group typically has a population of 600 to 3,000 people). We will just call them “districts” for short.</p>
</section>
<section id="solution-of-the-previous-hands-on" class="slide level2">
<h2>Solution of the previous <code>Hands on</code></h2>
<div id="3932b785" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:51.748689Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:51.748497Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:53.679938Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:53.679311Z&quot;}" data-outputid="54137682-51fa-43b1-e73a-87a287c1967f" data-scrolled="false" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="op">!</span>pip install flaml[automl]</span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-7"><a href=""></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: flaml[automl] in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (2.2.0)
Requirement already satisfied: NumPy&gt;=1.17 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from flaml[automl]) (2.0.2)
Requirement already satisfied: lightgbm&gt;=2.3.1 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from flaml[automl]) (4.5.0)
Requirement already satisfied: xgboost&lt;3.0.0,&gt;=0.90 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from flaml[automl]) (2.1.1)
Requirement already satisfied: scipy&gt;=1.4.1 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from flaml[automl]) (1.14.1)
Requirement already satisfied: pandas&gt;=1.1.4 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from flaml[automl]) (2.2.2)
Requirement already satisfied: scikit-learn&gt;=1.0.0 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from flaml[automl]) (1.5.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from pandas&gt;=1.1.4-&gt;flaml[automl]) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from pandas&gt;=1.1.4-&gt;flaml[automl]) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from pandas&gt;=1.1.4-&gt;flaml[automl]) (2024.1)
Requirement already satisfied: joblib&gt;=1.2.0 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from scikit-learn&gt;=1.0.0-&gt;flaml[automl]) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from scikit-learn&gt;=1.0.0-&gt;flaml[automl]) (3.5.0)
Requirement already satisfied: nvidia-nccl-cu12 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from xgboost&lt;3.0.0,&gt;=0.90-&gt;flaml[automl]) (2.23.4)
Requirement already satisfied: six&gt;=1.5 in /opt/hostedtoolcache/Python/3.11.10/x64/lib/python3.11/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.1.4-&gt;flaml[automl]) (1.16.0)</code></pre>
</div>
</div>
<div id="87eb7c60" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:53.683051Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:53.682517Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:53.833023Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:53.832530Z&quot;}" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="kw">def</span> preprocess(normalize<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb3-4"><a href=""></a>    df <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/w4bo/handsOnDataPipelines/main/materials/datasets/housing.csv"</span>, delimiter<span class="op">=</span><span class="st">","</span>)</span>
<span id="cb3-5"><a href=""></a>    num_df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"ocean_proximity"</span>, <span class="st">"median_house_value"</span>])</span>
<span id="cb3-6"><a href=""></a>    <span class="co"># Filling in (i.e., impute) missing values with the median value</span></span>
<span id="cb3-7"><a href=""></a>    num_df[<span class="st">"total_bedrooms"</span>] <span class="op">=</span> num_df[<span class="st">"total_bedrooms"</span>].fillna(num_df[<span class="st">"total_bedrooms"</span>].median())</span>
<span id="cb3-8"><a href=""></a>    <span class="co"># Add a new column: population_per_household = population / households</span></span>
<span id="cb3-9"><a href=""></a>    num_df[<span class="st">"population_per_household"</span>] <span class="op">=</span> num_df[<span class="st">"population"</span>] <span class="op">/</span> num_df[<span class="st">"households"</span>]</span>
<span id="cb3-10"><a href=""></a>    <span class="co"># Add a new column: rooms_per_household = total_rooms / households</span></span>
<span id="cb3-11"><a href=""></a>    num_df[<span class="st">"rooms_per_household"</span>] <span class="op">=</span> num_df[<span class="st">"total_rooms"</span>] <span class="op">/</span> num_df[<span class="st">"households"</span>]</span>
<span id="cb3-12"><a href=""></a>    <span class="co"># Add a new column: bedrooms_per_room = total_bedrooms / total_rooms</span></span>
<span id="cb3-13"><a href=""></a>    num_df[<span class="st">"bedrooms_per_room"</span>] <span class="op">=</span> num_df[<span class="st">"total_bedrooms"</span>] <span class="op">/</span> num_df[<span class="st">"total_rooms"</span>]</span>
<span id="cb3-14"><a href=""></a>    <span class="cf">if</span> normalize:</span>
<span id="cb3-15"><a href=""></a>        <span class="co"># Apply standardization to all the numeric columns</span></span>
<span id="cb3-16"><a href=""></a>        num_df <span class="op">=</span> (num_df <span class="op">-</span> num_df.mean()) <span class="op">/</span> num_df.std()</span>
<span id="cb3-17"><a href=""></a>    <span class="co"># One hot encode `ocean_proximity` since it is a categorical attribute</span></span>
<span id="cb3-18"><a href=""></a>    cat_df <span class="op">=</span> pd.get_dummies(df[<span class="st">"ocean_proximity"</span>], prefix<span class="op">=</span><span class="st">'ocean_proximity'</span>)</span>
<span id="cb3-19"><a href=""></a>    <span class="co"># Join all the dataframes</span></span>
<span id="cb3-20"><a href=""></a>    <span class="cf">return</span> pd.concat([num_df, cat_df, df[[<span class="st">"median_house_value"</span>]]], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-21"><a href=""></a></span>
<span id="cb3-22"><a href=""></a></span>
<span id="cb3-23"><a href=""></a>df <span class="op">=</span> preprocess()</span></code></pre></div>
</details>
</div>
<div id="6UU4itaaW-pF" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:53.835669Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:53.835277Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.513038Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.512353Z&quot;}" data-outputid="9890e739-2566-4e8f-ca63-a1f515c047d6" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb4-1"><a href=""></a>tmp <span class="op">=</span> df[[<span class="st">"population_per_household"</span>, <span class="st">"rooms_per_household"</span>, <span class="st">"bedrooms_per_room"</span>, <span class="st">"median_house_value"</span>]]</span>
<span id="cb4-2"><a href=""></a>sns.pairplot(tmp.sample(n<span class="op">=</span><span class="dv">1000</span>, random_state<span class="op">=</span><span class="dv">42</span>), hue<span class="op">=</span><span class="st">'median_house_value'</span>, markers<span class="op">=</span><span class="st">'+'</span>)</span>
<span id="cb4-3"><a href=""></a>plt.show()</span></code></pre></div>
</details>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-4-output-1.png" class="r-stretch"><div id="21a9526a" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.515752Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.515272Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.534463Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.533951Z&quot;}" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb5-1"><a href=""></a><span class="co"># For illustration only. Sklearn has train_test_split()</span></span>
<span id="cb5-2"><a href=""></a><span class="kw">def</span> split_train_test(data, test_ratio):</span>
<span id="cb5-3"><a href=""></a>    <span class="co"># get a list of random numbers</span></span>
<span id="cb5-4"><a href=""></a>    shuffled_indices <span class="op">=</span> np.random.permutation(<span class="bu">len</span>(data))</span>
<span id="cb5-5"><a href=""></a>    <span class="co"># define the size of test dataset</span></span>
<span id="cb5-6"><a href=""></a>    test_set_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data) <span class="op">*</span> test_ratio)</span>
<span id="cb5-7"><a href=""></a>    <span class="co"># the test dataset includes some indexes</span></span>
<span id="cb5-8"><a href=""></a>    test_indices <span class="op">=</span> shuffled_indices[:test_set_size]</span>
<span id="cb5-9"><a href=""></a>    <span class="co"># the train dataset includes the others (no overlapping)</span></span>
<span id="cb5-10"><a href=""></a>    train_indices <span class="op">=</span> shuffled_indices[test_set_size:]</span>
<span id="cb5-11"><a href=""></a>    <span class="co"># return the two dataframes</span></span>
<span id="cb5-12"><a href=""></a>    <span class="cf">return</span> data.iloc[train_indices], data.iloc[test_indices]</span>
<span id="cb5-13"><a href=""></a></span>
<span id="cb5-14"><a href=""></a></span>
<span id="cb5-15"><a href=""></a><span class="co"># get the train and test dataframes</span></span>
<span id="cb5-16"><a href=""></a>df_train, df_test <span class="op">=</span> split_train_test(df, <span class="fl">0.2</span>)</span>
<span id="cb5-17"><a href=""></a></span>
<span id="cb5-18"><a href=""></a><span class="co"># get the train feature matrix</span></span>
<span id="cb5-19"><a href=""></a>X_train <span class="op">=</span> df_train.drop(columns<span class="op">=</span>[<span class="st">"median_house_value"</span>]).to_numpy()</span>
<span id="cb5-20"><a href=""></a><span class="co"># get the test feature matrix</span></span>
<span id="cb5-21"><a href=""></a>X_test <span class="op">=</span> df_test.drop(columns<span class="op">=</span>[<span class="st">"median_house_value"</span>]).to_numpy()</span>
<span id="cb5-22"><a href=""></a><span class="co"># get the train label array</span></span>
<span id="cb5-23"><a href=""></a>y_train <span class="op">=</span> df_train[<span class="st">"median_house_value"</span>].to_numpy()</span>
<span id="cb5-24"><a href=""></a>y_test <span class="op">=</span> df_test[<span class="st">"median_house_value"</span>].to_numpy()  <span class="co"># get the test label array</span></span></code></pre></div>
</details>
</div>
<div id="09fe3dce" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.537042Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.536703Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.553036Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.552413Z&quot;}" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb6-2"><a href=""></a>y <span class="op">=</span> df[<span class="st">"median_house_value"</span>]  <span class="co"># labels</span></span>
<span id="cb6-3"><a href=""></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">"median_house_value"</span>])  <span class="co"># input data</span></span>
<span id="cb6-4"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.33</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</details>
</div>
<div id="613643ea" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.555715Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.555381Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.569705Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.569109Z&quot;}" data-outputid="a4442b92-29c4-4d21-c35d-448acb919b71" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb7-1"><a href=""></a>X_train</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">population_per_household</th>
<th data-quarto-table-cell-role="th">rooms_per_household</th>
<th data-quarto-table-cell-role="th">bedrooms_per_room</th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR OCEAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5088</td>
<td>0.643716</td>
<td>-0.773361</td>
<td>-0.765917</td>
<td>-0.803424</td>
<td>-0.533722</td>
<td>-0.617660</td>
<td>-0.582062</td>
<td>-1.521075</td>
<td>-0.043300</td>
<td>-0.905868</td>
<td>2.156065</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17096</td>
<td>-1.327803</td>
<td>0.855889</td>
<td>0.346470</td>
<td>0.003317</td>
<td>-0.173677</td>
<td>-0.362464</td>
<td>-0.189731</td>
<td>0.185559</td>
<td>-0.066782</td>
<td>0.307455</td>
<td>-0.586009</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5617</td>
<td>0.653698</td>
<td>-0.862314</td>
<td>1.061575</td>
<td>-0.675538</td>
<td>-0.650558</td>
<td>-0.336856</td>
<td>-0.676222</td>
<td>-0.169422</td>
<td>0.121441</td>
<td>-0.245505</td>
<td>0.205376</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20060</td>
<td>0.154579</td>
<td>0.111491</td>
<td>-0.368636</td>
<td>-0.479353</td>
<td>-0.350123</td>
<td>0.230050</td>
<td>-0.333586</td>
<td>-1.170516</td>
<td>0.140728</td>
<td>-0.466744</td>
<td>0.482602</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">895</td>
<td>-1.193041</td>
<td>0.893343</td>
<td>-1.163197</td>
<td>1.132297</td>
<td>1.597935</td>
<td>1.159000</td>
<td>1.591454</td>
<td>0.063284</td>
<td>-0.057725</td>
<td>-0.331705</td>
<td>0.346285</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11284</td>
<td>0.803433</td>
<td>-0.866996</td>
<td>0.505382</td>
<td>-0.598530</td>
<td>-0.800776</td>
<td>-0.677706</td>
<td>-0.738995</td>
<td>1.315560</td>
<td>-0.003697</td>
<td>0.282936</td>
<td>-0.960430</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11964</td>
<td>1.067966</td>
<td>-0.754634</td>
<td>0.346470</td>
<td>0.205461</td>
<td>0.079070</td>
<td>0.289213</td>
<td>-0.132189</td>
<td>-0.431973</td>
<td>0.080259</td>
<td>0.581850</td>
<td>-0.443985</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5390</td>
<td>0.593804</td>
<td>-0.749952</td>
<td>0.584838</td>
<td>-0.245123</td>
<td>0.076685</td>
<td>0.291863</td>
<td>0.071824</td>
<td>-0.492820</td>
<td>0.025170</td>
<td>-0.582935</td>
<td>0.874037</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">860</td>
<td>-1.193041</td>
<td>0.912070</td>
<td>-1.083741</td>
<td>0.430524</td>
<td>0.143449</td>
<td>0.310406</td>
<td>0.155521</td>
<td>0.973001</td>
<td>0.010421</td>
<td>0.390575</td>
<td>-0.717278</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15795</td>
<td>-1.422636</td>
<td>1.001024</td>
<td>1.856137</td>
<td>0.728926</td>
<td>1.855451</td>
<td>1.053919</td>
<td>1.941937</td>
<td>-0.681733</td>
<td>-0.092620</td>
<td>-0.819030</td>
<td>1.492377</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>13828 rows × 16 columns</p>
</div>
</div>
</div>
<div id="456e291b" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.571990Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.571635Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.576757Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.576273Z&quot;}" data-outputid="6c3936ab-8f37-40e2-817d-19538d68a8c7" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb8-1"><a href=""></a>y_train</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>5088     121400.0
17096    363700.0
5617     205600.0
20060     47600.0
895      236000.0
           ...   
11284    229200.0
11964     97800.0
5390     222100.0
860      283500.0
15795    325000.0
Name: median_house_value, Length: 13828, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="regression" class="slide level2">
<h2>Regression</h2>
<div id="805e7157" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.579128Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.578788Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.612684Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.611384Z&quot;}" data-outputid="8690e44b-d89e-441c-abb7-329217939c72" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb10-1"><a href=""></a><span class="co"># Choose a class of model, Apply linear regression</span></span>
<span id="cb10-2"><a href=""></a><span class="co"># (https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html)</span></span>
<span id="cb10-3"><a href=""></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression  <span class="co"># import the model</span></span>
<span id="cb10-4"><a href=""></a><span class="co"># Choose model hyperparameters and initialize the model (i.e., the estimator)</span></span>
<span id="cb10-5"><a href=""></a>lin_reg <span class="op">=</span> LinearRegression(fit_intercept<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-6"><a href=""></a><span class="co"># Model fitting</span></span>
<span id="cb10-7"><a href=""></a>lin_reg.fit(X_train, y_train)  <span class="co"># train it</span></span>
<span id="cb10-8"><a href=""></a><span class="co"># "LinearRegression fits a linear model with coefficients w = (w1, ..., wp) to minimize the residual</span></span>
<span id="cb10-9"><a href=""></a><span class="co"># sum of squares between the observed targets in the dataset, and the targets predicted by the linear approximation."</span></span>
<span id="cb10-10"><a href=""></a>lin_reg.coef_</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([-56678.25415922, -56570.43784763,  14012.48612813,   6065.60436301,
         7794.76152315, -44411.72364438,  36464.94733357,  78235.6199298 ,
          623.98096453,   7861.81047911,  18857.77231068, -22083.12212996,
       -57203.42335754, 126522.31313893, -28661.2527942 , -18574.51485723])</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://user-images.githubusercontent.com/18005592/232785531-1258fd6b-78a8-4f0a-9bde-bcc7f416f14f.png"></p>
<figcaption>image</figcaption>
</figure>
</div>
<div id="deb75fc9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.615484Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.615149Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.623217Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.622696Z&quot;}" data-outputid="240c7e9e-dfe4-4606-acca-09f86309f0a1" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb12-1"><a href=""></a><span class="co"># predict the cost of houses in the test set</span></span>
<span id="cb12-2"><a href=""></a>housing_predictions <span class="op">=</span> lin_reg.predict(X_test)</span>
<span id="cb12-3"><a href=""></a>housing_predictions</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([ 62413.7678525 , 120560.31036082, 261786.7058476 , ...,
       109483.51261867, 126282.2974808 , 227980.65278688])</code></pre>
</div>
</div>
<p>This checklist can help you while building your projects</p>
<p>Frame the problem and look at the big picture</p>
<ul>
<li>✔ Define the objective in business terms</li>
<li>✖ How should performance be measured? (let’s do this!)</li>
</ul>
<p>We are facing a regression problem</p>
<ul>
<li>A typical performance measure for regression problems is the Root Mean Square Error (RMSE)</li>
<li>RMSE is the standard deviation of the residuals (prediction errors)</li>
<li>Residuals are a measure of how far from the regression line data points are; RMSE is a measure of how spread out these residuals are</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://user-images.githubusercontent.com/18005592/232786035-abaca941-12c5-44b0-9085-e9908512803d.png"></p>
<figcaption>image</figcaption>
</figure>
</div>
<div id="a764f2b9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.626985Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.625847Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.772818Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.772349Z&quot;}" data-outputid="67c9d925-8b17-4d76-a6b5-b6afe9e27a99" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb14-1"><a href=""></a>lin_mse <span class="op">=</span> mean_squared_error(y_test, housing_predictions)  <span class="co"># check the error</span></span>
<span id="cb14-2"><a href=""></a>lin_rmse <span class="op">=</span> np.sqrt(lin_mse)  <span class="co"># apply the squared root of the error</span></span>
<span id="cb14-3"><a href=""></a><span class="bu">print</span>(lin_rmse)  <span class="co"># print it</span></span>
<span id="cb14-4"><a href=""></a></span>
<span id="cb14-5"><a href=""></a><span class="co"># visualize some predictions</span></span>
<span id="cb14-6"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'y_test'</span>: y_test[:<span class="dv">10</span>].to_numpy(), <span class="st">'y_pred'</span>: housing_predictions[:<span class="dv">10</span>]}, index<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)])</span>
<span id="cb14-7"><a href=""></a>df.plot.bar(rot<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>70532.346029265</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lab-06-housing_files/figure-revealjs/cell-11-output-2.png"></p>
</figure>
</div>
</div>
</div>
<p>This is better than nothing, but clearly not a great score: most districts’ <code>median_housing_values</code> range between 120K USD and 265K USD, so a typical prediction error of ~70K USD is not very satisfying. This is an example of a model underfitting the training data.</p>
<p>https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html</p>
<p>“A random forest is a meta estimator that fits a number of classifying decision trees on various sub-samples of the dataset and uses averaging to improve the predictive accuracy and control over-fitting. The sub-sample size is controlled with the max_samples parameter if bootstrap=True (default), otherwise the whole dataset is used to build each tree.”</p>
<div id="109abc76" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.775070Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.774727Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:33:57.810095Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:33:57.809602Z&quot;}" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor  <span class="co"># import the model</span></span>
<span id="cb16-2"><a href=""></a></span>
<span id="cb16-3"><a href=""></a></span>
<span id="cb16-4"><a href=""></a><span class="kw">def</span> run_forest(n_estimators, max_features, min_samples_split<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb16-5"><a href=""></a>    <span class="co"># initialize the model (i.e., the estimator)</span></span>
<span id="cb16-6"><a href=""></a>    forest_reg <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span>n_estimators, max_features<span class="op">=</span>max_features, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb16-7"><a href=""></a>    forest_reg.fit(X_train, y_train)  <span class="co"># train it</span></span>
<span id="cb16-8"><a href=""></a>    <span class="co"># predict the cost of houses in the test set</span></span>
<span id="cb16-9"><a href=""></a>    housing_predictions <span class="op">=</span> forest_reg.predict(X_test)</span>
<span id="cb16-10"><a href=""></a></span>
<span id="cb16-11"><a href=""></a>    forest_rmse <span class="op">=</span> mean_squared_error(y_test, housing_predictions, squared<span class="op">=</span><span class="va">True</span>)  <span class="co"># check the error</span></span>
<span id="cb16-12"><a href=""></a>    forest_rmse <span class="op">=</span> np.sqrt(forest_rmse)  <span class="co"># apply the squared root of the error</span></span>
<span id="cb16-13"><a href=""></a>    <span class="bu">print</span>(forest_rmse)</span>
<span id="cb16-14"><a href=""></a></span>
<span id="cb16-15"><a href=""></a>    df <span class="op">=</span> pd.DataFrame({<span class="st">'y_test'</span>: y_test[:<span class="dv">10</span>].to_numpy(), <span class="st">'y_pred'</span>: housing_predictions[:<span class="dv">10</span>]}, index<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)])</span>
<span id="cb16-16"><a href=""></a>    df.plot.bar(rot<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb16-17"><a href=""></a>    <span class="cf">return</span> forest_reg</span></code></pre></div>
</details>
</div>
<div id="9c488742" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:33:57.812865Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:33:57.812363Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:34:09.942596Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:34:09.941891Z&quot;}" data-outputid="f4584412-8ad3-4fd6-c502-b8787e68e3d7" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb17-1"><a href=""></a>forest_reg <span class="op">=</span> run_forest(<span class="dv">100</span>, <span class="fl">1.0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>50155.05753085368</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lab-06-housing_files/figure-revealjs/cell-13-output-2.png"></p>
</figure>
</div>
</div>
</div>
<p>Look at parameters used by our current forest</p>
<div id="f0235826" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:34:09.945072Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:34:09.944771Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:34:09.949086Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:34:09.948551Z&quot;}" data-outputid="ef64edc2-59a9-48a1-cb0d-08785ca187a8" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb19-1"><a href=""></a>forest_reg.get_params()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'criterion': 'squared_error',
 'max_depth': None,
 'max_features': 1.0,
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'monotonic_cst': None,
 'n_estimators': 100,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
</section>
<section id="hyperparameter-tuning" class="slide level2">
<h2>Hyperparameter tuning</h2>
<p>Hyper-parameters: parameters that are not directly learnt within estimators</p>
<ul>
<li>In scikit-learn they are passed as arguments to the constructor of the estimator classes</li>
<li>Any parameter provided when constructing an estimator may be optimized</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb21-1"><a href=""></a>estimator.get_params()</span></code></pre></div>
<p>A search consists of:</p>
<ul>
<li>an estimator</li>
<li>a parameter space</li>
<li>a method for searching or sampling candidates</li>
<li>a cross-validation scheme</li>
<li>a score function</li>
</ul>
</section>
<section id="cross-validation" class="slide level2">
<h2>Cross validation</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://user-images.githubusercontent.com/18005592/232793622-e98002b4-d58b-465b-8a3d-e7b3d0dafe6f.png"></p>
<figcaption>image</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://user-images.githubusercontent.com/18005592/232802005-d3a1aff6-23d8-4704-8a3f-a219d2155d30.png"></p>
<figcaption>Picture1</figcaption>
</figure>
</div>
</section>
<section id="hyper-parameter-tuning" class="slide level2">
<h2>Hyper-parameter tuning</h2>
<p>There are many search algorithms:</p>
<ul>
<li><em>Random</em>
<ul>
<li>“The parameters of the estimator used to apply these methods are optimized by cross-validated search over parameter settings. In contrast to GridSearchCV, not all parameter values are tried out, but rather a fixed number of parameter settings is sampled from the specified distributions. The number of parameter settings that are tried is given by n_iter.”</li>
<li>https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html</li>
</ul></li>
<li>Grid</li>
<li>AutoML</li>
</ul>
</section>
<section id="random-search" class="slide level2">
<h2>Random search</h2>
<div id="8d94f505" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:34:09.951353Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:34:09.951042Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:19.980029Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:19.979377Z&quot;}" data-outputid="e8ff8305-48f8-489a-9c30-5dff16650f1b" data-scrolled="true" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb22-1"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb22-2"><a href=""></a></span>
<span id="cb22-3"><a href=""></a>random_grid <span class="op">=</span> {</span>
<span id="cb22-4"><a href=""></a>    <span class="co"># Number of trees in random forest</span></span>
<span id="cb22-5"><a href=""></a>    <span class="st">'n_estimators'</span>: [<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>],</span>
<span id="cb22-6"><a href=""></a>    <span class="co"># Number of features to consider at every split</span></span>
<span id="cb22-7"><a href=""></a>    <span class="st">'max_features'</span>: [<span class="fl">1.0</span>, <span class="st">'sqrt'</span>],</span>
<span id="cb22-8"><a href=""></a>    <span class="st">'min_samples_split'</span>: [<span class="dv">2</span>, <span class="dv">5</span>]</span>
<span id="cb22-9"><a href=""></a>}</span>
<span id="cb22-10"><a href=""></a></span>
<span id="cb22-11"><a href=""></a><span class="co"># Fit the random search model</span></span>
<span id="cb22-12"><a href=""></a>rf_random <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>forest_reg, param_distributions<span class="op">=</span>random_grid, cv<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb22-13"><a href=""></a>rf_random.fit(X_train, y_train)</span>
<span id="cb22-14"><a href=""></a>rf_random.best_params_</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 10 candidates, totalling 30 fits
[CV] END max_features=1.0, min_samples_split=2, n_estimators=10; total time=   0.8s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=10; total time=   0.7s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=10; total time=   0.8s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=50; total time=   1.0s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=50; total time=   1.0s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=50; total time=   1.0s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=10; total time=   0.2s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=10; total time=   0.2s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=10; total time=   0.2s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=25; total time=   1.9s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=25; total time=   1.9s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=25; total time=   1.9s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=100; total time=   7.1s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=100; total time=   6.9s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=100; total time=   6.9s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=10; total time=   0.7s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=10; total time=   0.7s
[CV] END max_features=1.0, min_samples_split=5, n_estimators=10; total time=   0.7s
[CV] END max_features=sqrt, min_samples_split=2, n_estimators=25; total time=   0.6s
[CV] END max_features=sqrt, min_samples_split=2, n_estimators=25; total time=   0.6s
[CV] END max_features=sqrt, min_samples_split=2, n_estimators=25; total time=   0.6s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=100; total time=   7.6s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=100; total time=   7.5s
[CV] END max_features=1.0, min_samples_split=2, n_estimators=100; total time=   7.5s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=100; total time=   2.1s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=100; total time=   2.1s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=100; total time=   2.1s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=25; total time=   0.5s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=25; total time=   0.5s
[CV] END max_features=sqrt, min_samples_split=5, n_estimators=25; total time=   0.5s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>{'n_estimators': 100, 'min_samples_split': 5, 'max_features': 'sqrt'}</code></pre>
</div>
</div>
<div id="f40f18a9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:19.982453Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:19.982049Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:23.720586Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:23.719933Z&quot;}" data-outputid="28de0675-820b-49db-d617-d7ebb3936c17" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb25-1"><a href=""></a>run_forest(n_estimators<span class="op">=</span><span class="dv">100</span>, min_samples_split<span class="op">=</span><span class="dv">5</span>, max_features<span class="op">=</span><span class="st">'sqrt'</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>49296.853444113134</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestRegressor(max_features='sqrt', random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomForestRegressor<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestRegressor.html">?<span>Documentation for RandomForestRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomForestRegressor(max_features='sqrt', random_state=42)</pre></div> </div></div></div></div>
</div>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-16-output-3.png" class="r-stretch"></section>
<section id="dimensionality-reduction" class="slide level2">
<h2>Dimensionality reduction</h2>
<div id="41167ddd" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:23.723134Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:23.722634Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:24.029116Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:24.028603Z&quot;}" data-outputid="3fd9659d-cbcb-4589-ff31-a5687caaaed2" data-scrolled="true" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb27-1"><a href=""></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb27-2"><a href=""></a></span>
<span id="cb27-3"><a href=""></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-4"><a href=""></a>result <span class="op">=</span> pca.fit_transform(X_train.values)</span>
<span id="cb27-5"><a href=""></a></span>
<span id="cb27-6"><a href=""></a>plt.scatter(</span>
<span id="cb27-7"><a href=""></a>    x<span class="op">=</span>result[:, <span class="dv">0</span>],</span>
<span id="cb27-8"><a href=""></a>    y<span class="op">=</span>result[:, <span class="dv">1</span>],</span>
<span id="cb27-9"><a href=""></a>    c<span class="op">=</span>y_train,</span>
<span id="cb27-10"><a href=""></a>    s<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb27-11"><a href=""></a>    cmap<span class="op">=</span><span class="st">'viridis'</span></span>
<span id="cb27-12"><a href=""></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lab-06-housing_files/figure-revealjs/cell-17-output-1.png"></p>
</figure>
</div>
</div>
</div>
<div id="3b18f9db" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:24.031309Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:24.031020Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:24.042248Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:24.041758Z&quot;}" data-outputid="f0cef294-9fef-4815-977a-70400dbc099f" data-scrolled="true" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb28-1"><a href=""></a><span class="co"># Dump components relations with features</span></span>
<span id="cb28-2"><a href=""></a>pd.DataFrame(pca.components_, columns<span class="op">=</span>X_train.columns, index<span class="op">=</span>[<span class="st">'PC1'</span>, <span class="st">'PC2'</span>])</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">population_per_household</th>
<th data-quarto-table-cell-role="th">rooms_per_household</th>
<th data-quarto-table-cell-role="th">bedrooms_per_room</th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR OCEAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">PC1</td>
<td>0.067570</td>
<td>-0.064488</td>
<td>-0.218377</td>
<td>0.481213</td>
<td>0.491136</td>
<td>0.475472</td>
<td>0.491947</td>
<td>0.045903</td>
<td>-0.004028</td>
<td>0.007194</td>
<td>-0.011824</td>
<td>0.014685</td>
<td>0.001303</td>
<td>-0.000042</td>
<td>-0.013497</td>
<td>-0.002449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PC2</td>
<td>-0.593374</td>
<td>0.610175</td>
<td>-0.081621</td>
<td>0.108533</td>
<td>0.009148</td>
<td>-0.021333</td>
<td>0.004461</td>
<td>0.222566</td>
<td>0.008746</td>
<td>0.284716</td>
<td>-0.304254</td>
<td>-0.140430</td>
<td>0.082383</td>
<td>-0.000152</td>
<td>0.079831</td>
<td>-0.021631</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="HYDBmdVCXjFV" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:24.044376Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:24.044181Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:34.766442Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:34.765865Z&quot;}" data-outputid="8a922751-723f-41bf-989a-ba8c39e91498" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb29-1"><a href=""></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb29-2"><a href=""></a></span>
<span id="cb29-3"><a href=""></a>tsne <span class="op">=</span> TSNE(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-4"><a href=""></a>result <span class="op">=</span> tsne.fit_transform(X_train.head(<span class="dv">3000</span>))</span>
<span id="cb29-5"><a href=""></a></span>
<span id="cb29-6"><a href=""></a>plt.scatter(</span>
<span id="cb29-7"><a href=""></a>    x<span class="op">=</span>result[:, <span class="dv">0</span>],</span>
<span id="cb29-8"><a href=""></a>    y<span class="op">=</span>result[:, <span class="dv">1</span>],</span>
<span id="cb29-9"><a href=""></a>    c<span class="op">=</span>y_train.head(<span class="dv">3000</span>),</span>
<span id="cb29-10"><a href=""></a>    s<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb29-11"><a href=""></a>    cmap<span class="op">=</span><span class="st">'viridis'</span></span>
<span id="cb29-12"><a href=""></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lab-06-housing_files/figure-revealjs/cell-19-output-1.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="classification" class="slide level2">
<h2>Classification</h2>
<p>Can we turn this into a classification problem?</p>
<div id="f16c0883" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:34.768734Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:34.768462Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:34.919827Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:34.919302Z&quot;}" data-outputid="049fe2a8-9c8f-4064-cc3b-f991f465a2bb" data-scrolled="false" data-execution_count="19">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb30-1"><a href=""></a>df <span class="op">=</span> preprocess(<span class="va">False</span>)  <span class="co"># clean the dataset withtout standardization</span></span>
<span id="cb30-2"><a href=""></a>bins <span class="op">=</span> [<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>]  <span class="co"># the labels we are gonna use</span></span>
<span id="cb30-3"><a href=""></a><span class="co"># map bins of values into labels</span></span>
<span id="cb30-4"><a href=""></a>df[<span class="st">"median_house_value"</span>] <span class="op">=</span> pd.cut(df[<span class="st">"median_house_value"</span>], <span class="dv">3</span>, labels<span class="op">=</span>bins)</span>
<span id="cb30-5"><a href=""></a>df[<span class="st">"median_house_value"</span>].hist()  <span class="co"># plot them</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lab-06-housing_files/figure-revealjs/cell-20-output-1.png"></p>
</figure>
</div>
</div>
</div>
<p>For the sake of performance, we are going to use a manually defined set of features</p>
<div id="eafc83b9" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:34.921989Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:34.921816Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:34.927145Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:34.926737Z&quot;}" data-execution_count="20">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb31-1"><a href=""></a>y <span class="op">=</span> df[<span class="st">"median_house_value"</span>]  <span class="co"># labels</span></span>
<span id="cb31-2"><a href=""></a><span class="co"># consider only some features from the train dataset</span></span>
<span id="cb31-3"><a href=""></a>X <span class="op">=</span> df[[<span class="st">"latitude"</span>, <span class="st">"longitude"</span>, <span class="st">"median_income"</span>, <span class="st">"population"</span>, <span class="st">"households"</span>, <span class="st">"total_bedrooms"</span>]]</span>
<span id="cb31-4"><a href=""></a><span class="co"># split the dataset</span></span>
<span id="cb31-5"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.33</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</details>
</div>
<p>Computing performance</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://user-images.githubusercontent.com/18005592/232803278-7a0e5182-4267-410a-a809-7edc54a47980.png"></p>
<figcaption>Picture2</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://user-images.githubusercontent.com/18005592/232803261-1cae7aac-e3fc-4467-bb45-65455d7a34a7.png"></p>
<figcaption>Picture3</figcaption>
</figure>
</div>
<ul>
<li>Precision: <span class="math inline">\(\frac{tp}{tp + fp}\)</span></li>
<li>Recall: <span class="math inline">\(\frac{tp}{tp + fn}\)</span></li>
<li>Accuracy: <span class="math inline">\(\frac{tp + tn}{tp + tn + fp + fpn}\)</span></li>
<li>F1-score: <span class="math inline">\(2 \cdot \frac{precision \cdot recall}{precision + recall}\)</span></li>
</ul>
<p>Summing up - Accuracy is used when TP and TN are more important while F1-score is used when FN and FP are - Accuracy can be used when the class distribution is similar, while F1-score is a better when there are imbalanced classes</p>
<div id="f6a910d0" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:34.929127Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:34.928966Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:35.055402Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:35.054900Z&quot;}" data-outputid="82053cf2-a092-429d-ecb4-d43592966a25" data-execution_count="21">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb32-1"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb32-2"><a href=""></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb32-3"><a href=""></a><span class="co"># initialize the model</span></span>
<span id="cb32-4"><a href=""></a>clf <span class="op">=</span> tree.DecisionTreeClassifier(criterion<span class="op">=</span><span class="st">"entropy"</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-5"><a href=""></a>clf <span class="op">=</span> clf.fit(X_train, y_train)  <span class="co"># train it</span></span>
<span id="cb32-6"><a href=""></a><span class="co"># predict the cost of houses in the test set</span></span>
<span id="cb32-7"><a href=""></a>housing_predictions <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb32-8"><a href=""></a><span class="co"># check the error</span></span>
<span id="cb32-9"><a href=""></a>accuracy <span class="op">=</span> accuracy_score(y_test, housing_predictions)</span>
<span id="cb32-10"><a href=""></a>accuracy</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>0.768349970640047</code></pre>
</div>
</div>
<div id="0a816a7f" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:35.057618Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:35.057395Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:35.176937Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:35.176372Z&quot;}" data-outputid="2e6106d2-46a7-4a47-ed82-5e4ea92d1c6c" data-execution_count="22">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb34-1"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb34-2"><a href=""></a><span class="bu">print</span>(classification_report(y_test, housing_predictions, target_names<span class="op">=</span>bins))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

         low       0.67      0.70      0.68       958
      medium       0.84      0.84      0.84      3303
        high       0.71      0.70      0.70      2551

    accuracy                           0.77      6812
   macro avg       0.74      0.75      0.74      6812
weighted avg       0.77      0.77      0.77      6812
</code></pre>
</div>
</div>
<div id="017f3c68" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:35.179194Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:35.178989Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:36.330859Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:36.330198Z&quot;}" data-outputid="68f262ca-ef73-4f29-9af9-2f6e010b4659" data-scrolled="true" data-execution_count="23">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb36-1"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">12</span>))</span>
<span id="cb36-2"><a href=""></a>tree.plot_tree(clf, fontsize<span class="op">=</span><span class="dv">10</span>, feature_names<span class="op">=</span>X_train.columns, class_names<span class="op">=</span>bins, max_depth<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[Text(0.5, 0.9166666666666666, 'median_income &lt;= 4.12\nentropy = 1.435\nsamples = 13828\nvalue = [1970.0, 6786.0, 5072.0]\nclass = medium'),
 Text(0.25, 0.75, 'median_income &lt;= 2.662\nentropy = 1.099\nsamples = 8778\nvalue = [413, 5957, 2408]\nclass = medium'),
 Text(0.375, 0.8333333333333333, 'True  '),
 Text(0.125, 0.5833333333333334, 'latitude &lt;= 37.89\nentropy = 0.731\nsamples = 3835\nvalue = [81, 3211, 543]\nclass = medium'),
 Text(0.0625, 0.4166666666666667, 'longitude &lt;= -122.305\nentropy = 0.837\nsamples = 2927\nvalue = [79, 2340, 508]\nclass = medium'),
 Text(0.03125, 0.25, 'latitude &lt;= 37.755\nentropy = 1.263\nsamples = 57\nvalue = [13, 7, 37]\nclass = high'),
 Text(0.015625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.046875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.09375, 0.25, 'longitude &lt;= -117.125\nentropy = 0.796\nsamples = 2870\nvalue = [66, 2333, 471]\nclass = medium'),
 Text(0.078125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.109375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.1875, 0.4166666666666667, 'latitude &lt;= 38.955\nentropy = 0.258\nsamples = 908\nvalue = [2, 871, 35]\nclass = medium'),
 Text(0.15625, 0.25, 'longitude &lt;= -121.575\nentropy = 0.379\nsamples = 503\nvalue = [2.0, 469.0, 32.0]\nclass = medium'),
 Text(0.140625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.171875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.21875, 0.25, 'longitude &lt;= -120.04\nentropy = 0.063\nsamples = 405\nvalue = [0, 402, 3]\nclass = medium'),
 Text(0.203125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.234375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.375, 0.5833333333333334, 'latitude &lt;= 37.935\nentropy = 1.263\nsamples = 4943\nvalue = [332, 2746, 1865]\nclass = medium'),
 Text(0.3125, 0.4166666666666667, 'longitude &lt;= -122.235\nentropy = 1.323\nsamples = 4012\nvalue = [328, 1972, 1712]\nclass = medium'),
 Text(0.28125, 0.25, 'latitude &lt;= 37.815\nentropy = 1.154\nsamples = 352\nvalue = [112, 17, 223]\nclass = high'),
 Text(0.265625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.296875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.34375, 0.25, 'longitude &lt;= -117.795\nentropy = 1.252\nsamples = 3660\nvalue = [216, 1955, 1489]\nclass = medium'),
 Text(0.328125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.359375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.4375, 0.4166666666666667, 'longitude &lt;= -122.395\nentropy = 0.683\nsamples = 931\nvalue = [4, 774, 153]\nclass = medium'),
 Text(0.40625, 0.25, 'latitude &lt;= 38.69\nentropy = 1.051\nsamples = 232\nvalue = [3, 140, 89]\nclass = medium'),
 Text(0.390625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.421875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.46875, 0.25, 'median_income &lt;= 3.135\nentropy = 0.457\nsamples = 699\nvalue = [1, 634, 64]\nclass = medium'),
 Text(0.453125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.484375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.75, 0.75, 'median_income &lt;= 5.854\nentropy = 1.438\nsamples = 5050\nvalue = [1557, 829, 2664]\nclass = high'),
 Text(0.625, 0.8333333333333333, '  False'),
 Text(0.625, 0.5833333333333334, 'longitude &lt;= -117.705\nentropy = 1.333\nsamples = 3335\nvalue = [493.0, 794.0, 2048.0]\nclass = high'),
 Text(0.5625, 0.4166666666666667, 'latitude &lt;= 37.985\nentropy = 1.295\nsamples = 2824\nvalue = [461, 547, 1816]\nclass = high'),
 Text(0.53125, 0.25, 'longitude &lt;= -122.205\nentropy = 1.253\nsamples = 2420\nvalue = [454, 358, 1608]\nclass = high'),
 Text(0.515625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.546875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.59375, 0.25, 'longitude &lt;= -122.325\nentropy = 1.107\nsamples = 404\nvalue = [7.0, 189.0, 208.0]\nclass = high'),
 Text(0.578125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.609375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.6875, 0.4166666666666667, 'latitude &lt;= 33.915\nentropy = 1.274\nsamples = 511\nvalue = [32, 247, 232]\nclass = medium'),
 Text(0.65625, 0.25, 'longitude &lt;= -117.155\nentropy = 1.293\nsamples = 360\nvalue = [30.0, 126.0, 204.0]\nclass = high'),
 Text(0.640625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.671875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.71875, 0.25, 'median_income &lt;= 5.273\nentropy = 0.789\nsamples = 151\nvalue = [2, 121, 28]\nclass = medium'),
 Text(0.703125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.734375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.875, 0.5833333333333334, 'median_income &lt;= 7.815\nentropy = 1.072\nsamples = 1715\nvalue = [1064, 35, 616]\nclass = low'),
 Text(0.8125, 0.4166666666666667, 'longitude &lt;= -117.865\nentropy = 1.151\nsamples = 1191\nvalue = [573, 32, 586]\nclass = high'),
 Text(0.78125, 0.25, 'latitude &lt;= 37.925\nentropy = 1.125\nsamples = 928\nvalue = [515, 22, 391]\nclass = low'),
 Text(0.765625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.796875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.84375, 0.25, 'median_income &lt;= 6.3\nentropy = 0.98\nsamples = 263\nvalue = [58, 10, 195]\nclass = high'),
 Text(0.828125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.859375, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.9375, 0.4166666666666667, 'total_bedrooms &lt;= 33.0\nentropy = 0.367\nsamples = 524\nvalue = [491, 3, 30]\nclass = low'),
 Text(0.90625, 0.25, 'median_income &lt;= 13.155\nentropy = 1.531\nsamples = 14\nvalue = [6, 3, 5]\nclass = low'),
 Text(0.890625, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.921875, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.96875, 0.25, 'median_income &lt;= 9.04\nentropy = 0.282\nsamples = 510\nvalue = [485, 0, 25]\nclass = low'),
 Text(0.953125, 0.08333333333333333, '\n  (...)  \n'),
 Text(0.984375, 0.08333333333333333, '\n  (...)  \n')]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lab-06-housing_files/figure-revealjs/cell-24-output-2.png"></p>
</figure>
</div>
</div>
</div>
<div id="zgtE_hRwXpWj" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:36.333160Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:36.332820Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:39.227494Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:39.226898Z&quot;}" data-outputid="8744a206-7a5a-4625-8927-e1118481dcea" data-execution_count="24">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb38-1"><a href=""></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb38-2"><a href=""></a></span>
<span id="cb38-3"><a href=""></a>forest_cls <span class="op">=</span> RandomForestClassifier(criterion<span class="op">=</span><span class="st">"entropy"</span>, random_state<span class="op">=</span><span class="dv">42</span>) <span class="co"># initialize the model</span></span>
<span id="cb38-4"><a href=""></a>forest_cls <span class="op">=</span> forest_cls.fit(X_train, y_train) <span class="co"># train it</span></span>
<span id="cb38-5"><a href=""></a>housing_predictions <span class="op">=</span> forest_cls.predict(X_test) <span class="co"># predict the cost of houses in the test set</span></span>
<span id="cb38-6"><a href=""></a></span>
<span id="cb38-7"><a href=""></a>accuracy <span class="op">=</span> accuracy_score(y_test, housing_predictions) <span class="co"># check the error</span></span>
<span id="cb38-8"><a href=""></a>accuracy</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0.8247210804462712</code></pre>
</div>
</div>
<div id="oXKGFKaUXriL" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:39.229584Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:39.229380Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:35:39.233372Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:35:39.232885Z&quot;}" data-outputid="f8a1ee63-8169-46e4-ab6b-cc58fd0ec666" data-execution_count="25">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb40-1"><a href=""></a>forest_cls.get_params()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'entropy',
 'max_depth': None,
 'max_features': 'sqrt',
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'monotonic_cst': None,
 'n_estimators': 100,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
<div id="iJNLDjRuXtv0" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:35:39.235318Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:35:39.235145Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:36:10.176892Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:36:10.176300Z&quot;}" data-outputid="72c212c8-fc8d-4a4b-fc20-f915f86e4d3f" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb42-1"><a href=""></a>random_grid <span class="op">=</span> {<span class="st">'n_estimators'</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>], <span class="co"># Number of trees in random forest</span></span>
<span id="cb42-2"><a href=""></a>               <span class="st">'max_features'</span>: [<span class="fl">1.0</span>, <span class="st">'sqrt'</span>], <span class="co"># Number of features to consider at every split</span></span>
<span id="cb42-3"><a href=""></a>               <span class="st">'min_samples_leaf'</span>: [<span class="dv">1</span>, <span class="dv">5</span>],</span>
<span id="cb42-4"><a href=""></a>               <span class="st">'max_depth'</span>: [<span class="dv">2</span>, <span class="dv">5</span>]</span>
<span id="cb42-5"><a href=""></a>              }</span>
<span id="cb42-6"><a href=""></a></span>
<span id="cb42-7"><a href=""></a><span class="co"># Fit the random search model</span></span>
<span id="cb42-8"><a href=""></a>rf_random <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>forest_cls, param_distributions<span class="op">=</span>random_grid, cv<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb42-9"><a href=""></a>rf_random.fit(X_train, y_train)</span>
<span id="cb42-10"><a href=""></a>rf_random.best_params_</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 10 candidates, totalling 30 fits
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=1, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=1, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=1, n_estimators=150; total time=   0.6s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=5, n_estimators=100; total time=   2.2s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=5, n_estimators=100; total time=   2.1s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=5, n_estimators=100; total time=   2.1s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=50; total time=   0.5s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=50; total time=   0.5s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=50; total time=   0.5s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=1, n_estimators=50; total time=   0.4s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=150; total time=   0.6s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.2s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.2s
[CV] END max_depth=2, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.2s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   2.1s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   2.2s
[CV] END max_depth=5, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   2.2s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   0.9s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   0.9s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=1, n_estimators=100; total time=   0.9s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.4s
[CV] END max_depth=5, max_features=sqrt, min_samples_leaf=5, n_estimators=50; total time=   0.4s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=5, n_estimators=150; total time=   1.4s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=5, n_estimators=150; total time=   1.4s
[CV] END max_depth=2, max_features=1.0, min_samples_leaf=5, n_estimators=150; total time=   1.4s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>{'n_estimators': 100,
 'min_samples_leaf': 1,
 'max_features': 1.0,
 'max_depth': 5}</code></pre>
</div>
</div>
<div id="Prs9v1QQXvbo" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:36:10.179253Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:36:10.178910Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:36:10.685226Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:36:10.684680Z&quot;}" data-outputid="fc61d6be-42bc-4eb8-8d91-5394c252c714" data-execution_count="27">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb45-1"><a href=""></a>forest_cls <span class="op">=</span> RandomForestClassifier(criterion<span class="op">=</span><span class="st">"gini"</span>, random_state<span class="op">=</span><span class="dv">42</span>, n_estimators<span class="op">=</span><span class="dv">50</span>, max_features<span class="op">=</span><span class="st">"sqrt"</span>, min_samples_leaf<span class="op">=</span><span class="dv">1</span>, max_depth<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb45-2"><a href=""></a>forest_cls <span class="op">=</span> forest_cls.fit(X_train, y_train) <span class="co"># train it</span></span>
<span id="cb45-3"><a href=""></a>housing_predictions <span class="op">=</span> forest_cls.predict(X_test) <span class="co"># predict the cost of houses in the test set</span></span>
<span id="cb45-4"><a href=""></a></span>
<span id="cb45-5"><a href=""></a>accuracy <span class="op">=</span> accuracy_score(y_test, housing_predictions) <span class="co"># check the error</span></span>
<span id="cb45-6"><a href=""></a>accuracy</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0.7298884321785085</code></pre>
</div>
</div>
<div id="1Wr3yNmyXxE8" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:36:10.687393Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:36:10.687200Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:36:10.691629Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:36:10.691140Z&quot;}" data-outputid="937a6ff7-345d-4b67-e480-49b65e761dff" data-execution_count="28">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb47-1"><a href=""></a>forest_cls.get_params()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'gini',
 'max_depth': 5,
 'max_features': 'sqrt',
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'monotonic_cst': None,
 'n_estimators': 50,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
</section>
<section id="automl-with-flaml" class="slide level2">
<h2>AutoML with FLAML</h2>
<div id="13d88cfc" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:36:10.693891Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:36:10.693587Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:36:10.702346Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:36:10.701769Z&quot;}" data-outputid="320b4213-5797-4338-f51b-16a82636b439" data-execution_count="29">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb49-1"><a href=""></a>scale_mapper <span class="op">=</span> {<span class="st">"low"</span>: <span class="dv">1</span>, <span class="st">"medium"</span>: <span class="dv">2</span>, <span class="st">"high"</span>: <span class="dv">3</span>}</span>
<span id="cb49-2"><a href=""></a>y_train <span class="op">=</span> y_train.replace(scale_mapper)</span>
<span id="cb49-3"><a href=""></a>y_test <span class="op">=</span> y_test.replace(scale_mapper)</span>
<span id="cb49-4"><a href=""></a>y_train</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>5088     1
17096    3
5617     2
20060    1
895      2
        ..
11284    2
11964    1
5390     2
860      2
15795    2
Name: median_house_value, Length: 13828, dtype: category
Categories (3, int64): [1 &lt; 2 &lt; 3]</code></pre>
</div>
</div>
<p>Check https://microsoft.github.io/FLAML/docs/reference/automl/automl#automl-objects</p>
<div id="1898d4d7" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:36:10.704732Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:36:10.704336Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:37:11.853871Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:37:11.853446Z&quot;}" data-outputid="67453331-b383-437a-d618-c8e747d50d1b" data-execution_count="30">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb51-1"><a href=""></a><span class="im">from</span> flaml <span class="im">import</span> AutoML</span>
<span id="cb51-2"><a href=""></a></span>
<span id="cb51-3"><a href=""></a>automl_settings <span class="op">=</span> {</span>
<span id="cb51-4"><a href=""></a>    <span class="st">"time_budget"</span>: <span class="dv">60</span>,  <span class="co"># in seconds</span></span>
<span id="cb51-5"><a href=""></a>    <span class="st">"metric"</span>: <span class="st">"accuracy"</span>,</span>
<span id="cb51-6"><a href=""></a>    <span class="st">"task"</span>: <span class="st">"classification"</span>,</span>
<span id="cb51-7"><a href=""></a>}</span>
<span id="cb51-8"><a href=""></a></span>
<span id="cb51-9"><a href=""></a>automl <span class="op">=</span> AutoML()</span>
<span id="cb51-10"><a href=""></a>automl.fit(X_train, y_train, <span class="op">**</span>automl_settings)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[flaml.automl.logger: 09-17 10:36:10] {1680} INFO - task = classification
[flaml.automl.logger: 09-17 10:36:10] {1691} INFO - Evaluation method: cv
[flaml.automl.logger: 09-17 10:36:10] {1789} INFO - Minimizing error metric: 1-accuracy
[flaml.automl.logger: 09-17 10:36:10] {1901} INFO - List of ML learners in AutoML Run: ['lgbm', 'rf', 'xgboost', 'extra_tree', 'xgb_limitdepth', 'lrl1']
[flaml.automl.logger: 09-17 10:36:10] {2219} INFO - iteration 0, current learner lgbm
[flaml.automl.logger: 09-17 10:36:10] {2345} INFO - Estimated sufficient time budget=1407s. Estimated necessary time budget=32s.
[flaml.automl.logger: 09-17 10:36:10] {2392} INFO -  at 0.2s,   estimator lgbm's best error=0.3435, best estimator lgbm's best error=0.3435
[flaml.automl.logger: 09-17 10:36:10] {2219} INFO - iteration 1, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.2s,   estimator lgbm's best error=0.3435, best estimator lgbm's best error=0.3435
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 2, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.3s,   estimator lgbm's best error=0.3199, best estimator lgbm's best error=0.3199
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 3, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.4s,   estimator lgbm's best error=0.2283, best estimator lgbm's best error=0.2283
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 4, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.5s,   estimator lgbm's best error=0.2283, best estimator lgbm's best error=0.2283
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 5, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.6s,   estimator lgbm's best error=0.2081, best estimator lgbm's best error=0.2081
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 6, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.7s,   estimator lgbm's best error=0.2081, best estimator lgbm's best error=0.2081
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 7, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 0.8s,   estimator lgbm's best error=0.2081, best estimator lgbm's best error=0.2081
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 8, current learner lgbm
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 1.0s,   estimator lgbm's best error=0.1994, best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 9, current learner xgboost
[flaml.automl.logger: 09-17 10:36:11] {2392} INFO -  at 1.2s,   estimator xgboost's best error=0.3410,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:11] {2219} INFO - iteration 10, current learner xgboost
[flaml.automl.logger: 09-17 10:36:12] {2392} INFO -  at 1.3s,   estimator xgboost's best error=0.3198,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:12] {2219} INFO - iteration 11, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:12] {2392} INFO -  at 1.5s,   estimator extra_tree's best error=0.3828,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:12] {2219} INFO - iteration 12, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:12] {2392} INFO -  at 1.7s,   estimator extra_tree's best error=0.3687,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:12] {2219} INFO - iteration 13, current learner rf
[flaml.automl.logger: 09-17 10:36:12] {2392} INFO -  at 1.9s,   estimator rf's best error=0.3757,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:12] {2219} INFO - iteration 14, current learner rf
[flaml.automl.logger: 09-17 10:36:12] {2392} INFO -  at 2.1s,   estimator rf's best error=0.3132,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:12] {2219} INFO - iteration 15, current learner rf
[flaml.automl.logger: 09-17 10:36:13] {2392} INFO -  at 2.3s,   estimator rf's best error=0.3132,   best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:13] {2219} INFO - iteration 16, current learner lgbm
[flaml.automl.logger: 09-17 10:36:13] {2392} INFO -  at 2.4s,   estimator lgbm's best error=0.1994, best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:13] {2219} INFO - iteration 17, current learner xgboost
[flaml.automl.logger: 09-17 10:36:13] {2392} INFO -  at 2.5s,   estimator xgboost's best error=0.3198,  best estimator lgbm's best error=0.1994
[flaml.automl.logger: 09-17 10:36:13] {2219} INFO - iteration 18, current learner lgbm
[flaml.automl.logger: 09-17 10:36:14] {2392} INFO -  at 3.5s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:14] {2219} INFO - iteration 19, current learner rf
[flaml.automl.logger: 09-17 10:36:14] {2392} INFO -  at 3.8s,   estimator rf's best error=0.3132,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:14] {2219} INFO - iteration 20, current learner lgbm
[flaml.automl.logger: 09-17 10:36:16] {2392} INFO -  at 5.4s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:16] {2219} INFO - iteration 21, current learner rf
[flaml.automl.logger: 09-17 10:36:16] {2392} INFO -  at 5.7s,   estimator rf's best error=0.2894,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:16] {2219} INFO - iteration 22, current learner lgbm
[flaml.automl.logger: 09-17 10:36:17] {2392} INFO -  at 6.4s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:17] {2219} INFO - iteration 23, current learner lgbm
[flaml.automl.logger: 09-17 10:36:17] {2392} INFO -  at 7.2s,   estimator lgbm's best error=0.1670, best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:17] {2219} INFO - iteration 24, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:18] {2392} INFO -  at 7.3s,   estimator extra_tree's best error=0.3687,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:18] {2219} INFO - iteration 25, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:18] {2392} INFO -  at 7.5s,   estimator extra_tree's best error=0.3687,   best estimator lgbm's best error=0.1670
[flaml.automl.logger: 09-17 10:36:18] {2219} INFO - iteration 26, current learner lgbm
[flaml.automl.logger: 09-17 10:36:19] {2392} INFO -  at 8.9s,   estimator lgbm's best error=0.1647, best estimator lgbm's best error=0.1647
[flaml.automl.logger: 09-17 10:36:19] {2219} INFO - iteration 27, current learner xgboost
[flaml.automl.logger: 09-17 10:36:19] {2392} INFO -  at 9.0s,   estimator xgboost's best error=0.3154,  best estimator lgbm's best error=0.1647
[flaml.automl.logger: 09-17 10:36:19] {2219} INFO - iteration 28, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:19] {2392} INFO -  at 9.2s,   estimator extra_tree's best error=0.3272,   best estimator lgbm's best error=0.1647
[flaml.automl.logger: 09-17 10:36:19] {2219} INFO - iteration 29, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:20] {2392} INFO -  at 9.4s,   estimator extra_tree's best error=0.3207,   best estimator lgbm's best error=0.1647
[flaml.automl.logger: 09-17 10:36:20] {2219} INFO - iteration 30, current learner lgbm
[flaml.automl.logger: 09-17 10:36:23] {2392} INFO -  at 12.8s,  estimator lgbm's best error=0.1647, best estimator lgbm's best error=0.1647
[flaml.automl.logger: 09-17 10:36:23] {2219} INFO - iteration 31, current learner lgbm
[flaml.automl.logger: 09-17 10:36:24] {2392} INFO -  at 13.6s,  estimator lgbm's best error=0.1647, best estimator lgbm's best error=0.1647
[flaml.automl.logger: 09-17 10:36:24] {2219} INFO - iteration 32, current learner lgbm
[flaml.automl.logger: 09-17 10:36:27] {2392} INFO -  at 17.2s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:27] {2219} INFO - iteration 33, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:28] {2392} INFO -  at 17.4s,  estimator extra_tree's best error=0.3207,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:28] {2219} INFO - iteration 34, current learner lgbm
[flaml.automl.logger: 09-17 10:36:29] {2392} INFO -  at 18.8s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:29] {2219} INFO - iteration 35, current learner rf
[flaml.automl.logger: 09-17 10:36:29] {2392} INFO -  at 19.1s,  estimator rf's best error=0.2894,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:29] {2219} INFO - iteration 36, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:30] {2392} INFO -  at 19.4s,  estimator extra_tree's best error=0.2973,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:30] {2219} INFO - iteration 37, current learner xgboost
[flaml.automl.logger: 09-17 10:36:30] {2392} INFO -  at 19.6s,  estimator xgboost's best error=0.2865,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:30] {2219} INFO - iteration 38, current learner xgboost
[flaml.automl.logger: 09-17 10:36:30] {2392} INFO -  at 19.7s,  estimator xgboost's best error=0.2865,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:30] {2219} INFO - iteration 39, current learner xgboost
[flaml.automl.logger: 09-17 10:36:30] {2392} INFO -  at 19.8s,  estimator xgboost's best error=0.2865,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:30] {2219} INFO - iteration 40, current learner xgboost
[flaml.automl.logger: 09-17 10:36:30] {2392} INFO -  at 20.0s,  estimator xgboost's best error=0.2865,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:30] {2219} INFO - iteration 41, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:30] {2392} INFO -  at 20.2s,  estimator extra_tree's best error=0.2973,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:30] {2219} INFO - iteration 42, current learner lgbm
[flaml.automl.logger: 09-17 10:36:32] {2392} INFO -  at 21.8s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:32] {2219} INFO - iteration 43, current learner xgboost
[flaml.automl.logger: 09-17 10:36:32] {2392} INFO -  at 21.9s,  estimator xgboost's best error=0.2810,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:32] {2219} INFO - iteration 44, current learner extra_tree
[flaml.automl.logger: 09-17 10:36:32] {2392} INFO -  at 22.2s,  estimator extra_tree's best error=0.2973,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:32] {2219} INFO - iteration 45, current learner xgboost
[flaml.automl.logger: 09-17 10:36:33] {2392} INFO -  at 22.4s,  estimator xgboost's best error=0.2364,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:33] {2219} INFO - iteration 46, current learner xgboost
[flaml.automl.logger: 09-17 10:36:33] {2392} INFO -  at 22.6s,  estimator xgboost's best error=0.2364,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:33] {2219} INFO - iteration 47, current learner xgboost
[flaml.automl.logger: 09-17 10:36:33] {2392} INFO -  at 22.9s,  estimator xgboost's best error=0.2204,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:33] {2219} INFO - iteration 48, current learner lgbm
[flaml.automl.logger: 09-17 10:36:43] {2392} INFO -  at 32.6s,  estimator lgbm's best error=0.1641, best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:43] {2219} INFO - iteration 49, current learner xgboost
[flaml.automl.logger: 09-17 10:36:43] {2392} INFO -  at 32.8s,  estimator xgboost's best error=0.2015,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:43] {2219} INFO - iteration 50, current learner xgboost
[flaml.automl.logger: 09-17 10:36:43] {2392} INFO -  at 33.2s,  estimator xgboost's best error=0.2015,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:43] {2219} INFO - iteration 51, current learner xgboost
[flaml.automl.logger: 09-17 10:36:44] {2392} INFO -  at 33.5s,  estimator xgboost's best error=0.2015,  best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:44] {2219} INFO - iteration 52, current learner rf
[flaml.automl.logger: 09-17 10:36:44] {2392} INFO -  at 33.8s,  estimator rf's best error=0.2746,   best estimator lgbm's best error=0.1641
[flaml.automl.logger: 09-17 10:36:44] {2219} INFO - iteration 53, current learner lgbm
[flaml.automl.logger: 09-17 10:36:49] {2392} INFO -  at 38.9s,  estimator lgbm's best error=0.1640, best estimator lgbm's best error=0.1640
[flaml.automl.logger: 09-17 10:36:49] {2219} INFO - iteration 54, current learner lgbm
[flaml.automl.logger: 09-17 10:36:53] {2392} INFO -  at 42.5s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 09-17 10:36:53] {2219} INFO - iteration 55, current learner xgboost
[flaml.automl.logger: 09-17 10:36:53] {2392} INFO -  at 43.0s,  estimator xgboost's best error=0.1887,  best estimator lgbm's best error=0.1631
[flaml.automl.logger: 09-17 10:36:53] {2219} INFO - iteration 56, current learner lgbm
[flaml.automl.logger: 09-17 10:36:56] {2392} INFO -  at 45.6s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 09-17 10:36:56] {2219} INFO - iteration 57, current learner lgbm
[flaml.automl.logger: 09-17 10:37:01] {2392} INFO -  at 51.0s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 09-17 10:37:01] {2219} INFO - iteration 58, current learner xgboost
[flaml.automl.logger: 09-17 10:37:02] {2392} INFO -  at 51.3s,  estimator xgboost's best error=0.1887,  best estimator lgbm's best error=0.1631
[flaml.automl.logger: 09-17 10:37:02] {2219} INFO - iteration 59, current learner lgbm
[flaml.automl.logger: 09-17 10:37:11] {2392} INFO -  at 60.4s,  estimator lgbm's best error=0.1631, best estimator lgbm's best error=0.1631
[flaml.automl.logger: 09-17 10:37:11] {2628} INFO - retrain lgbm for 0.7s
[flaml.automl.logger: 09-17 10:37:11] {2631} INFO - retrained model: LGBMClassifier(colsample_bytree=np.float64(0.6782006405163307),
               learning_rate=np.float64(0.08222714104485472), max_bin=511,
               min_child_samples=5, n_estimators=1, n_jobs=-1, num_leaves=254,
               reg_alpha=np.float64(0.003934614746573571),
               reg_lambda=np.float64(0.003560646472734122), verbose=-1)
[flaml.automl.logger: 09-17 10:37:11] {1931} INFO - fit succeeded
[flaml.automl.logger: 09-17 10:37:11] {1932} INFO - Time taken to find the best model: 42.494866371154785</code></pre>
</div>
</div>
<div id="8f9415cc" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:37:11.856195Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:37:11.855882Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:37:11.861654Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:37:11.861093Z&quot;}" data-outputid="29cb1af8-ff84-4d3a-9777-b53de04f264b" data-execution_count="31">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb53-1"><a href=""></a>automl.model.estimator</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LGBMClassifier(colsample_bytree=np.float64(0.6782006405163307),
               learning_rate=np.float64(0.08222714104485472), max_bin=511,
               min_child_samples=5, n_estimators=1, n_jobs=-1, num_leaves=254,
               reg_alpha=np.float64(0.003934614746573571),
               reg_lambda=np.float64(0.003560646472734122), verbose=-1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LGBMClassifier<span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LGBMClassifier(colsample_bytree=np.float64(0.6782006405163307),
               learning_rate=np.float64(0.08222714104485472), max_bin=511,
               min_child_samples=5, n_estimators=1, n_jobs=-1, num_leaves=254,
               reg_alpha=np.float64(0.003934614746573571),
               reg_lambda=np.float64(0.003560646472734122), verbose=-1)</pre></div> </div></div></div></div>
</div>
</div>
<div id="6b21842b" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:37:11.863975Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:37:11.863671Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:37:11.905497Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:37:11.904181Z&quot;}" data-outputid="552ae0e5-5a1e-49fe-eba5-1bdc54fc0319" data-execution_count="32">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb54-1"><a href=""></a><span class="co"># Score the model</span></span>
<span id="cb54-2"><a href=""></a>housing_predictions <span class="op">=</span> automl.predict(X_test)</span>
<span id="cb54-3"><a href=""></a>housing_predictions</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([1, 1, 3, ..., 1, 1, 2])</code></pre>
</div>
</div>
<div id="d50c42f0" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-09-17T10:37:11.908446Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-09-17T10:37:11.908204Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-09-17T10:37:12.042610Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-09-17T10:37:12.041926Z&quot;}" data-outputid="1f838665-666f-466e-82d2-4dd5c5d96492" data-execution_count="33">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines"><code class="sourceCode python"><span id="cb56-1"><a href=""></a>automl_rmse <span class="op">=</span> mean_squared_error(y_test, housing_predictions, squared<span class="op">=</span><span class="va">True</span>)  <span class="co"># check the error</span></span>
<span id="cb56-2"><a href=""></a>automl_rmse <span class="op">=</span> np.sqrt(automl_rmse)  <span class="co"># apply the squared root of the error</span></span>
<span id="cb56-3"><a href=""></a><span class="bu">print</span>(automl_rmse)</span>
<span id="cb56-4"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'y_test'</span>: y_test[:<span class="dv">10</span>].to_numpy(), <span class="st">'y_pred'</span>: housing_predictions[:<span class="dv">10</span>]}, index<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)])</span>
<span id="cb56-5"><a href=""></a>df.plot.bar(rot<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.4072882696396063</code></pre>
</div>

</div>
<img data-src="lab-06-housing_files/figure-revealjs/cell-34-output-2.png" class="r-stretch"><div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Matteo Francia - Machine Learning - A.Y. 2024/25</p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lab-06-housing_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lab-06-housing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lab-06-housing_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lab-06-housing_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1100,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>